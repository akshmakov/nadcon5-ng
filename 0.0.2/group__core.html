<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>NADCON5-ng: NADCON5 Core Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_style_overrides.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NADCON5-ng
   &#160;<span id="projectnumber">0.0.2</span>
   </div>
   <div id="projectbrief">NADCON5 Next Generation Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>About</span></a></li>
      <li><a href="pages.html"><span>Manual</span></a></li>
      <li class="current"><a href="modules.html"><span>Code&#160;Documentation</span></a></li>
      <li><a href="https://nc5ng.org"><span>Project&#160;Homepage</span></a></li>
      <li><a href="https://github.com/nc5ng/nadcon5-ng"><span>Project&#160;Github</span></a></li>
      <li><a href="files.html"><span>Index</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__core.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#dirs">Directories</a> &#124;
<a href="#func-members">Programs, Functions, and Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">NADCON5 Core Library</div>  </div>
</div><!--header-->
<div class="contents">

<p>Programs and Functions which are responsible for computing the grid transformations used to build NADCON5.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="dirs"></a>
Directories</h2></td></tr>
<tr class="memitem:dir_462f77f6b7eb607a32f8a29cc299b51a"><td class="memItemLeft" align="right" valign="top">directory&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_462f77f6b7eb607a32f8a29cc299b51a.html">BinSource</a></td></tr>
<tr class="memdesc:dir_462f77f6b7eb607a32f8a29cc299b51a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Folder containing <a class="el" href="group__core.html">NADCON5 Core Library</a> Programs. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dir_ed91b8bd2cf1fe3f8ede164ac9ac75bf"><td class="memItemLeft" align="right" valign="top">directory&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_ed91b8bd2cf1fe3f8ede164ac9ac75bf.html">Subs</a></td></tr>
<tr class="memdesc:dir_ed91b8bd2cf1fe3f8ede164ac9ac75bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Folder containing <a class="el" href="group__core.html">NADCON5 Core Library</a> Subroutines. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Programs, Functions, and Subroutines</h2></td></tr>
<tr class="memitem:ga5614597c90588a48f6887c51b9fe3f57"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga5614597c90588a48f6887c51b9fe3f57">addem</a></td></tr>
<tr class="memdesc:ga5614597c90588a48f6887c51b9fe3f57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , adds one grid to another.  <a href="#ga5614597c90588a48f6887c51b9fe3f57">More...</a><br /></td></tr>
<tr class="separator:ga5614597c90588a48f6887c51b9fe3f57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7412e40b3811c1a0af4f53b945917a69"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga7412e40b3811c1a0af4f53b945917a69">b2xyz</a></td></tr>
<tr class="memdesc:ga7412e40b3811c1a0af4f53b945917a69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , converts <code>*.b</code> grid to <code>xyz</code>  <a href="#ga7412e40b3811c1a0af4f53b945917a69">More...</a><br /></td></tr>
<tr class="separator:ga7412e40b3811c1a0af4f53b945917a69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga53b9c3b6c272c62581749a8c6e89eb3d"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga53b9c3b6c272c62581749a8c6e89eb3d">convlv</a></td></tr>
<tr class="memdesc:ga53b9c3b6c272c62581749a8c6e89eb3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Convolves two grids.  <a href="#ga53b9c3b6c272c62581749a8c6e89eb3d">More...</a><br /></td></tr>
<tr class="separator:ga53b9c3b6c272c62581749a8c6e89eb3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61c0f40266dd43c2a77d88c91cb3f6ac"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga61c0f40266dd43c2a77d88c91cb3f6ac">decimate</a></td></tr>
<tr class="memdesc:ga61c0f40266dd43c2a77d88c91cb3f6ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Extract a reduced (1 of n) dataset.  <a href="#ga61c0f40266dd43c2a77d88c91cb3f6ac">More...</a><br /></td></tr>
<tr class="separator:ga61c0f40266dd43c2a77d88c91cb3f6ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4bad06e067b9affa9b0f59cef0adc6ec"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga4bad06e067b9affa9b0f59cef0adc6ec">gabs</a></td></tr>
<tr class="memdesc:ga4bad06e067b9affa9b0f59cef0adc6ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Convert values in a <code>*.b</code> grid to absolute value.  <a href="#ga4bad06e067b9affa9b0f59cef0adc6ec">More...</a><br /></td></tr>
<tr class="separator:ga4bad06e067b9affa9b0f59cef0adc6ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae48a8903c06928f4cfdeda12711566a6"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gae48a8903c06928f4cfdeda12711566a6">gscale</a></td></tr>
<tr class="memdesc:gae48a8903c06928f4cfdeda12711566a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Scales a grid by a factor.  <a href="#gae48a8903c06928f4cfdeda12711566a6">More...</a><br /></td></tr>
<tr class="separator:gae48a8903c06928f4cfdeda12711566a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae4a498ff62bccd7dbd17c4ca5d26b5cf"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gae4a498ff62bccd7dbd17c4ca5d26b5cf">gsqr</a></td></tr>
<tr class="memdesc:gae4a498ff62bccd7dbd17c4ca5d26b5cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Squares values in a <code>*.b</code> grid.  <a href="#gae4a498ff62bccd7dbd17c4ca5d26b5cf">More...</a><br /></td></tr>
<tr class="separator:gae4a498ff62bccd7dbd17c4ca5d26b5cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42a9950155f63d600bb7e30d779af7b4"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga42a9950155f63d600bb7e30d779af7b4">gsqrt</a></td></tr>
<tr class="memdesc:ga42a9950155f63d600bb7e30d779af7b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Square Root of values in a <code>*.b</code> grid.  <a href="#ga42a9950155f63d600bb7e30d779af7b4">More...</a><br /></td></tr>
<tr class="separator:ga42a9950155f63d600bb7e30d779af7b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82ccd3d068498097f669337f1917fa99"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga82ccd3d068498097f669337f1917fa99">regrd2</a></td></tr>
<tr class="memdesc:ga82ccd3d068498097f669337f1917fa99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , regrid data.  <a href="#ga82ccd3d068498097f669337f1917fa99">More...</a><br /></td></tr>
<tr class="separator:ga82ccd3d068498097f669337f1917fa99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d5145fe3c5bf851b4a0df2ff7145b48"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga0d5145fe3c5bf851b4a0df2ff7145b48">subtrc</a></td></tr>
<tr class="memdesc:ga0d5145fe3c5bf851b4a0df2ff7145b48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Subtract one grid from another.  <a href="#ga0d5145fe3c5bf851b4a0df2ff7145b48">More...</a><br /></td></tr>
<tr class="separator:ga0d5145fe3c5bf851b4a0df2ff7145b48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaddd91b04c391f82cba5511c45ae9d691"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gaddd91b04c391f82cba5511c45ae9d691">xyz2b</a></td></tr>
<tr class="memdesc:gaddd91b04c391f82cba5511c45ae9d691"><td class="mdescLeft">&#160;</td><td class="mdescRight">Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Converts GMT <code>*.grd</code> to a <code>*.b</code> NADCON style grid file.  <a href="#gaddd91b04c391f82cba5511c45ae9d691">More...</a><br /></td></tr>
<tr class="separator:gaddd91b04c391f82cba5511c45ae9d691"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga27ef6de6cc481c624a5558b20c38ba04"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga27ef6de6cc481c624a5558b20c38ba04">bicubic</a> (z, glamn, glomn, dla, dlo, nla, nlo, maxla, maxlo, xla, xlo, val)</td></tr>
<tr class="memdesc:ga27ef6de6cc481c624a5558b20c38ba04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to perform a 2-D cubic ("bicubic") interpolation.  <a href="#ga27ef6de6cc481c624a5558b20c38ba04">More...</a><br /></td></tr>
<tr class="separator:ga27ef6de6cc481c624a5558b20c38ba04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9228c4b11b96e50bee68421e66ed412"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gaf9228c4b11b96e50bee68421e66ed412">bilin</a> (data, glamn, glomn, dla, dlo, nla, nlo, maxla, maxlo, xla, xlo, val)</td></tr>
<tr class="memdesc:gaf9228c4b11b96e50bee68421e66ed412"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to perform bilinear interpolation.  <a href="#gaf9228c4b11b96e50bee68421e66ed412">More...</a><br /></td></tr>
<tr class="separator:gaf9228c4b11b96e50bee68421e66ed412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab451c989dfed05b90b17f4005dd5133a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gab451c989dfed05b90b17f4005dd5133a">biquad</a> (z, glamn, glomn, dla, dlo, nla, nlo, maxla, maxlo, xla, xlo, val)</td></tr>
<tr class="memdesc:gab451c989dfed05b90b17f4005dd5133a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to perform a 2-D quadratic ("biquadratic") interpolation.  <a href="#gab451c989dfed05b90b17f4005dd5133a">More...</a><br /></td></tr>
<tr class="separator:gab451c989dfed05b90b17f4005dd5133a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d046a9be31aa1d9b69abd6eb6117294"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga6d046a9be31aa1d9b69abd6eb6117294">bwplotcv</a> (ele, fname, bw, be, bs, bn, jm, b1, b2, maxplots, olddtm, newdtm, region, elecap, ij, igridsec, fn)</td></tr>
<tr class="memdesc:ga6d046a9be31aa1d9b69abd6eb6117294"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to make GMT calls to do a B/W coverage plot.  <a href="#ga6d046a9be31aa1d9b69abd6eb6117294">More...</a><br /></td></tr>
<tr class="separator:ga6d046a9be31aa1d9b69abd6eb6117294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82c09d84f1af66481bc8e975f3f986ae"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga82c09d84f1af66481bc8e975f3f986ae">bwplotvc</a> (ele, fname, bw, be, bs, bn, jm, b1, b2, maxplots, olddtm, newdtm, region, elecap, ij, xvlon, xvlat, xllon, xllat, lorvog, lorvopc, igridsec, fn)</td></tr>
<tr class="memdesc:ga82c09d84f1af66481bc8e975f3f986ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to make GMT calls to do a B/W vector plot.  <a href="#ga82c09d84f1af66481bc8e975f3f986ae">More...</a><br /></td></tr>
<tr class="separator:ga82c09d84f1af66481bc8e975f3f986ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga44465308a9701d8ffe256715e4f01215"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga44465308a9701d8ffe256715e4f01215">coplot</a> (ele, fname, bw, be, bs, bn, jm, b1, b2, maxplots, olddtm, newdtm, region, elecap, ij, cptlo, cpthi, cptin6, suffixused, igridsec, fn)</td></tr>
<tr class="memdesc:ga44465308a9701d8ffe256715e4f01215"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to make GMT calls to do Color Raster Rendering of Gridded Data.  <a href="#ga44465308a9701d8ffe256715e4f01215">More...</a><br /></td></tr>
<tr class="separator:ga44465308a9701d8ffe256715e4f01215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc3bebf5d61250a63b6d444e4514ad88"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gacc3bebf5d61250a63b6d444e4514ad88">coplotwcv</a> (ele, fname, bw, be, bs, bn, jm, b1, b2, maxplots, olddtm, newdtm, region, elecap, ij, cptlo, cpthi, cptin6, suffixused, igridsec, fn, cvfname)</td></tr>
<tr class="memdesc:gacc3bebf5d61250a63b6d444e4514ad88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to make GMT calls to do a color raster rendering of gridded data, with coverage overlaid.  <a href="#gacc3bebf5d61250a63b6d444e4514ad88">More...</a><br /></td></tr>
<tr class="separator:gacc3bebf5d61250a63b6d444e4514ad88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0a01789413f4554c379979dc8ef36768"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga0a01789413f4554c379979dc8ef36768">cpt</a> (ave, std, csm, xlo, xhi, xin)</td></tr>
<tr class="memdesc:ga0a01789413f4554c379979dc8ef36768"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine generates the color pallette variables for a GMT color plot.  <a href="#ga0a01789413f4554c379979dc8ef36768">More...</a><br /></td></tr>
<tr class="separator:ga0a01789413f4554c379979dc8ef36768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc3e084679aba567131d58415054bd59"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gadc3e084679aba567131d58415054bd59">cpt2</a> (med, csm, xlo, xhi, xin)</td></tr>
<tr class="memdesc:gadc3e084679aba567131d58415054bd59"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine generates the color pallette variables for a GMT color plot.  <a href="#gadc3e084679aba567131d58415054bd59">More...</a><br /></td></tr>
<tr class="separator:gadc3e084679aba567131d58415054bd59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d3311b2b903f11603ef30523e7069a9"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a> (x, f0, f1, f2, f3)</td></tr>
<tr class="memdesc:ga0d3311b2b903f11603ef30523e7069a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fits a cubic function through four points.  <a href="#ga0d3311b2b903f11603ef30523e7069a9">More...</a><br /></td></tr>
<tr class="separator:ga0d3311b2b903f11603ef30523e7069a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga456c2747eddc4e9792e9c052fc3dfb2a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga456c2747eddc4e9792e9c052fc3dfb2a">getgridbounds</a> (region, xn, xs, xw, xe)</td></tr>
<tr class="memdesc:ga456c2747eddc4e9792e9c052fc3dfb2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to collect up the GRID boundaries for use in creating NADCON 5.  <a href="#ga456c2747eddc4e9792e9c052fc3dfb2a">More...</a><br /></td></tr>
<tr class="separator:ga456c2747eddc4e9792e9c052fc3dfb2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7abb43855645428af96aacf2447e7caf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga7abb43855645428af96aacf2447e7caf">getmag</a> (x, ix)</td></tr>
<tr class="memdesc:ga7abb43855645428af96aacf2447e7caf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to return the magnitude of a double precision value.  <a href="#ga7abb43855645428af96aacf2447e7caf">More...</a><br /></td></tr>
<tr class="separator:ga7abb43855645428af96aacf2447e7caf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34660db69356d6ab42d986fc2f85d158"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga34660db69356d6ab42d986fc2f85d158">getmapbounds</a> (mapflag, maxplots, region, nplots, olddtm, newdtm, bw, be, bs, bn, jm, b1, b2, fn, lrv, rv0x, rv0y, rl0y)</td></tr>
<tr class="memdesc:ga34660db69356d6ab42d986fc2f85d158"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to collect up the MAP boundaries for use in creating NADCON 5.  <a href="#ga34660db69356d6ab42d986fc2f85d158">More...</a><br /></td></tr>
<tr class="separator:ga34660db69356d6ab42d986fc2f85d158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1593f511d0df7cf215e5eb55d297e515"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga1593f511d0df7cf215e5eb55d297e515">gridstats</a> (fname, ave, std, med)</td></tr>
<tr class="memdesc:ga1593f511d0df7cf215e5eb55d297e515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to print grid statistics to stdout.  <a href="#ga1593f511d0df7cf215e5eb55d297e515">More...</a><br /></td></tr>
<tr class="separator:ga1593f511d0df7cf215e5eb55d297e515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaec1b049dc4be13c46b684423fc31805e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gaec1b049dc4be13c46b684423fc31805e">indexxd</a> (n, nd, arr, indx)</td></tr>
<tr class="memdesc:gaec1b049dc4be13c46b684423fc31805e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to perform ?? indexing on floating point data (double precision)  <a href="#gaec1b049dc4be13c46b684423fc31805e">More...</a><br /></td></tr>
<tr class="separator:gaec1b049dc4be13c46b684423fc31805e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaada1f7f6294a20b1828bd4d1b7e37ca0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gaada1f7f6294a20b1828bd4d1b7e37ca0">indexxi</a> (n, nd, arr, indx)</td></tr>
<tr class="memdesc:gaada1f7f6294a20b1828bd4d1b7e37ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to perform ?? indexing on integer data.  <a href="#gaada1f7f6294a20b1828bd4d1b7e37ca0">More...</a><br /></td></tr>
<tr class="separator:gaada1f7f6294a20b1828bd4d1b7e37ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65b0a0e3ed4141584f0cd6f134541efd"><td class="memItemLeft" align="right" valign="top">integer *2 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga65b0a0e3ed4141584f0cd6f134541efd">iselect2</a> (k, n, arr, nmax)</td></tr>
<tr class="memdesc:ga65b0a0e3ed4141584f0cd6f134541efd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to select an element of a partially filled, but packed multi dimensional array, <code>integer*2</code>  <a href="#ga65b0a0e3ed4141584f0cd6f134541efd">More...</a><br /></td></tr>
<tr class="separator:ga65b0a0e3ed4141584f0cd6f134541efd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2a869479b7b9e7520a6ae75ed6aca46d"><td class="memItemLeft" align="right" valign="top">real *4 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga2a869479b7b9e7520a6ae75ed6aca46d">onzd</a> (x)</td></tr>
<tr class="memdesc:ga2a869479b7b9e7520a6ae75ed6aca46d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to round a digit to one significant figure (one non zero digit), single precision.  <a href="#ga2a869479b7b9e7520a6ae75ed6aca46d">More...</a><br /></td></tr>
<tr class="separator:ga2a869479b7b9e7520a6ae75ed6aca46d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc5c9acc8aedbc27aa45d5a78980e6d0"><td class="memItemLeft" align="right" valign="top">real *8 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gadc5c9acc8aedbc27aa45d5a78980e6d0">onzd2</a> (x)</td></tr>
<tr class="memdesc:gadc5c9acc8aedbc27aa45d5a78980e6d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to round a digit to one significant figure (one non zero digit), double precision.  <a href="#gadc5c9acc8aedbc27aa45d5a78980e6d0">More...</a><br /></td></tr>
<tr class="separator:gadc5c9acc8aedbc27aa45d5a78980e6d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga43be1e80c0bde6748f414d2eee05603f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a> (region, ifnum)</td></tr>
<tr class="memdesc:ga43be1e80c0bde6748f414d2eee05603f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to write GMT-based commands to create a shoreline Write GMT-based commands to create a shoreline based on region.  <a href="#ga43be1e80c0bde6748f414d2eee05603f">More...</a><br /></td></tr>
<tr class="separator:ga43be1e80c0bde6748f414d2eee05603f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa651c892588f1308f29a4b8b02ccd183"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a> (x, f0, f1, f2)</td></tr>
<tr class="memdesc:gaa651c892588f1308f29a4b8b02ccd183"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function fits a quadratic function through 3 points.  <a href="#gaa651c892588f1308f29a4b8b02ccd183">More...</a><br /></td></tr>
<tr class="separator:gaa651c892588f1308f29a4b8b02ccd183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gace8271d29dcfcca5a034f3c4c79fb3f5"><td class="memItemLeft" align="right" valign="top">real *8 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a> (k, n, arr, nmax)</td></tr>
<tr class="memdesc:gace8271d29dcfcca5a034f3c4c79fb3f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to select an element of a partially filled, but packed multi dimensional array, double precision.  <a href="#gace8271d29dcfcca5a034f3c4c79fb3f5">More...</a><br /></td></tr>
<tr class="separator:gace8271d29dcfcca5a034f3c4c79fb3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa591df09d79062c6f540cdb5ab808939"><td class="memItemLeft" align="right" valign="top">real *4 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gaa591df09d79062c6f540cdb5ab808939">select2</a> (k, n, arr, nmax)</td></tr>
<tr class="memdesc:gaa591df09d79062c6f540cdb5ab808939"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to select an element of a partially filled, but packed multi dimensional array, single precision.  <a href="#gaa591df09d79062c6f540cdb5ab808939">More...</a><br /></td></tr>
<tr class="separator:gaa591df09d79062c6f540cdb5ab808939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88bcf2faadec1776f556f062c07ac898"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga88bcf2faadec1776f556f062c07ac898">vecstats</a> (fname, n)</td></tr>
<tr class="memdesc:ga88bcf2faadec1776f556f062c07ac898"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to tell us how many thinned vectors were used to make a grid.  <a href="#ga88bcf2faadec1776f556f062c07ac898">More...</a><br /></td></tr>
<tr class="separator:ga88bcf2faadec1776f556f062c07ac898"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Programs and Functions which are responsible for computing the grid transformations used to build NADCON5. </p>
<p>The programs here can be considered "Library" Programs, or functions, which do the raw work of computing various transformations and conversions from <code>*.b</code> NADCON binary grid to a <code>GMT</code> style <code>*.grd</code> </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga5614597c90588a48f6887c51b9fe3f57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program addem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , adds one grid to another. </p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infileA</td><td>First Input File Name </td></tr>
    <tr><td class="paramname">infileB</td><td>Second Input File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name of A+B</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin1</code> Input File A</li>
<li><code>lin2</code> Input File B</li>
<li><code>lout</code> Output File to Write A+B </li>
</ul>

<p>Definition at line <a class="el" href="addem_8f_source.html#l00024">24</a> of file <a class="el" href="addem_8f_source.html">addem.f</a>.</p>

</div>
</div>
<a class="anchor" id="ga7412e40b3811c1a0af4f53b945917a69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program b2xyz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , converts <code>*.b</code> grid to <code>xyz</code> </p>
<p>Program to convert standard "*.b" grid formatted data to a binary xyz (lon, lat, value) list, which can then be used by GMT for various things (like running the GMT routine "xyz2grd", to get a "*.grd" file, which is useful for plotting, etc)</p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>Input File Name</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li>Input File defined by <code>infile</code></li>
</ul>
<h3>Program Outputs:</h3>
<ul>
<li><code>temp.xyz</code> </li>
</ul>

<p>Definition at line <a class="el" href="b2xyz_8f_source.html#l00031">31</a> of file <a class="el" href="b2xyz_8f_source.html">b2xyz.f</a>.</p>

</div>
</div>
<a class="anchor" id="ga27ef6de6cc481c624a5558b20c38ba04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bicubic </td>
          <td>(</td>
          <td class="paramtype">real*4, dimension(maxla,maxlo)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>glamn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>glomn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to perform a 2-D cubic ("bicubic") interpolation. </p>
<p>Performs interpolation at location "xla,xlo" off of grid "z", whose header information is the standard ".b" header information with additional inputs</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Input Grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glamn</td><td>minimum latitude (real*8 decimal degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glomn</td><td>minimum longitude (real*8 decimal degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dla</td><td>latitude spacing (real*8 decimal degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dlo</td><td>longitude spacing (real*8 decimal degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nla</td><td>number of lat rows (integer*4) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlo</td><td>number of lon cols (integer*4) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxla</td><td>actual dimensioned size of "z" in rows </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxlo</td><td>actual dimensioned size of "z" in cols </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xla</td><td>lat of pt for interpolation (real*8 dec. deg) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlo</td><td>lon of pt for interpolation (real*8 dec. deg) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>interpolated value (real*8)</td></tr>
  </table>
  </dd>
</dl>
<h3>Method:</h3>
<p>Fit a 4x4 window over the random point. Unless the point is less than one grid spacing from the edge of the grid, it will fall in the inner 2x2 cell, and the 4x4 cell will be centered upon that.</p>
<p>Thus, if our point of interest is the asterisk, the window will look like this: </p><pre class="fragment">       .  .  .  .
       .  .  .  .
       .  .* .  . 
       .  .  .  .</pre> 
<p>Definition at line <a class="el" href="bicubic_8f_source.html#l00041">41</a> of file <a class="el" href="bicubic_8f_source.html">bicubic.f</a>.</p>

<p>Referenced by <a class="el" href="checkgrid_8f_source.html#l00100">checkgrid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">c - Data is assumed real*4</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordtype">implicit real*8</span> (a-h,o-z)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordtype">real*4</span> z(maxla,maxlo)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c - Internal use</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordtype">real*4</span> x,y,fx0,fx1,fx2,fx3,<a class="code" href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">c - Find which row should be LEAST when fitting</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">c - a 4x4 window around xla.  </span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      difla = (xla - glamn)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      ratla = difla / dla</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      jla = int(ratla)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">c - Fix any edge overlaps</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordflow">if</span>(jla.lt.1)jla = 1</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">if</span>(jla.gt.nla-3)jla = nla-3</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">c - Find which column should be LEAST when fitting</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">c - a 4x4 window around xlo.</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      diflo = (xlo - glomn)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      ratlo = diflo / dlo</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      jlo = int(ratlo)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">c - Fix any edge overlaps</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">if</span>(jlo.lt.1)jlo = 1</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span>(jlo.gt.nlo-3)jlo = nlo-3</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">c - In the range of 0(westernmost) to</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">c - 3(easternmost) col, where is our</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">c - random lon value?  That is, x must</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">c - be real and fall between 0 and 3.</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">c - (Note, unless it is near an edge,</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">c - it will always be between 1 and 2)</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      x=(xlo-dlo*(jlo-1)-glomn)/dlo</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">if</span>(x.lt.0.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keyword">write</span>(6,100)x</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        stop</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  100 <span class="keyword">format</span>(</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;     *<span class="stringliteral">&#39;FATAL in bicubic:  x&lt;0 : &#39;</span>,f20.10)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span>(x.gt.3.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">write</span>(6,101)x</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        stop</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  101 <span class="keyword">format</span>(</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;     *<span class="stringliteral">&#39;FATAL in bicubic:  x&gt;3 : &#39;</span>,f20.10)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">c - In the range of 0(southernmost) to</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">c - 3(northernmost) row, where is our</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">c - random lat value?  That is, x must</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">c - be real and fall between 0 and 3.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">c - (Note, unless it is near an edge,</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">c - it will always be between 1 and 2)</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      y=(xla-dla*(jla-1)-glamn)/dla</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">if</span>(y.lt.0.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keyword">write</span>(6,102)y</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        stop</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  102 <span class="keyword">format</span>(</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;     *<span class="stringliteral">&#39;FATAL in bicubic:  y&lt;0 : &#39;</span>,f20.10)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">if</span>(y.gt.3.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keyword">write</span>(6,103)y</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        stop</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  103 <span class="keyword">format</span>(</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;     *<span class="stringliteral">&#39;FATAL in bicubic:  y&gt;3 : &#39;</span>,f20.10)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">c - Now do the interpolation.  First, build a 1-D cubic function</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">c - east-west in the southermost row and interpolate to longitude</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">c - &quot;xlo&quot; (at &quot;x&quot; for 0&lt;x&lt;3).  Then do it in the 2nd row,</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">c - then again in the 3rd, and finally the 4th and most northern row.  </span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">c - The last step is to fit a 1-D cubic function north-south at the</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">c - four previous interpolations, but this time to interpolate to </span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">c - latitude &quot;xla&quot; (at &quot;y&quot; for 0&lt;y&lt;3).  Obviously we </span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">c - could reverse the order, doing 4 north-south cubics</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">c - followed by one east-east and we&#39;d get the same answer.</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      fx0=<a class="code" href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a>(x,z(jla  ,jlo  ),z(jla  ,jlo+1),</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     *              z(jla  ,jlo+2),z(jla  ,jlo+3))</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      fx1=<a class="code" href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a>(x,z(jla+1,jlo  ),z(jla+1,jlo+1),</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;     *              z(jla+1,jlo+2),z(jla+1,jlo+3))</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      fx2=<a class="code" href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a>(x,z(jla+2,jlo  ),z(jla+2,jlo+1),</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     *              z(jla+2,jlo+2),z(jla+2,jlo+3))</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      fx3=<a class="code" href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a>(x,z(jla+3,jlo  ),z(jla+3,jlo+1),</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     *              z(jla+3,jlo+2),z(jla+3,jlo+3))</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      val=dble(<a class="code" href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a>(y,fx0,fx1,fx2,fx3))</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">c     write(6,1001)glamn,xla,jla,y</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">c     write(6,1002)glomn,xlo,jlo,x</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">c     write(6,1003)z(jla+3,jlo  ),z(jla+3,jlo+1),</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">c    *             z(jla+3,jlo+2),z(jla+3,jlo+3)</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">c     write(6,1003)z(jla+2,jlo  ),z(jla+2,jlo+1),</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">c    *             z(jla+2,jlo+2),z(jla+2,jlo+3)</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">c     write(6,1003)z(jla+1,jlo  ),z(jla+1,jlo+1),</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">c    *             z(jla+1,jlo+2),z(jla+1,jlo+3)</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">c     write(6,1003)z(jla  ,jlo  ),z(jla  ,jlo+1),</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">c    *             z(jla  ,jlo+2),z(jla  ,jlo+3)</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">c     write(6,1004)fx0,fx1,fx2,fx3,val</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">c     pause</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; 1001 <span class="keyword">format</span>(f14.10,1x,f14.10,1x,i8,1x,f8.5)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; 1002 <span class="keyword">format</span>(f14.10,1x,f14.10,1x,i8,1x,f8.5)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; 1003 <span class="keyword">format</span>(4(f15.8,1x))</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; 1004 <span class="keyword">format</span>(</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     *<span class="stringliteral">&#39;fx0 = &#39;</span>,f15.8,/,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     *<span class="stringliteral">&#39;fx1 = &#39;</span>,f15.8,/,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;     *<span class="stringliteral">&#39;fx2 = &#39;</span>,f15.8,/,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;     *<span class="stringliteral">&#39;fx3 = &#39;</span>,f15.8,/,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;     *<span class="stringliteral">&#39;val = &#39;</span>,f15.8)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_ga0d3311b2b903f11603ef30523e7069a9"><div class="ttname"><a href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a></div><div class="ttdeci">real function cubterp(x, f0, f1, f2, f3)</div><div class="ttdoc">This function fits a cubic function through four points. </div><div class="ttdef"><b>Definition:</b> <a href="cubterp_8f_source.html#l00052">cubterp.f:52</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga27ef6de6cc481c624a5558b20c38ba04_icgraph.svg" width="200" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaf9228c4b11b96e50bee68421e66ed412"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bilin </td>
          <td>(</td>
          <td class="paramtype">real*4, dimension(maxla,maxlo)&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>glamn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>glomn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to perform bilinear interpolation. </p>
<p>Performs a bilinear interpolation at location <code>xla,xlo</code> off of grid <code>data</code>, whose header information is the standard <code>.b</code> header information</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Input Data assumed to be real*4 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glamn</td><td>minimum latitude (real*8 decimal degrees) <code>*.b</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glomn</td><td>minimum longitude (real*8 decimal degrees) <code>*.b</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dla</td><td>latitude spacing (real*8 decimal degrees) <code>*.b</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dlo</td><td>longitude spacing (real*8 decimal degrees) <code>*.b</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nla</td><td>number of lat rows (integer*4) <code>*.b</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlo</td><td>number of lon cols (integer*4) <code>*.b</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxla</td><td>actual dimensioned size of "data" in rows <code>*.b</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxlo</td><td>actual dimensioned size of "data" in cols <code>*.b</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xla</td><td>lat of pt for interpolation (real*8 dec. def) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlo</td><td>lon of pt for interpolation (real*8 dec. def) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>interpolated value (real*8) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bilin_8f_source.html#l00027">27</a> of file <a class="el" href="bilin_8f_source.html">bilin.f</a>.</p>

<p>Referenced by <a class="el" href="checkgrid_8f_source.html#l00100">checkgrid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">c - Subroutine to perform a bilinear interpolation</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">c - at location &quot;xla,xlo&quot; off of grid &quot;data&quot;, whose</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">c - header information is the standard &quot;.b&quot; header</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">c - information of</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">c -    glamn = minimum latitude   (real*8 decimal degrees)</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">c -    glomn = minimum longitude  (real*8 decimal degrees)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">c -    dla   = latitude spacing   (real*8 decimal degrees)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">c -    dlo   = longitude spacing  (real*8 decimal degrees)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">c -    nla   = number of lat rows (integer*4)</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">c -    nlo   = number of lon cols (integer*4)</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">c -    maxla = actual dimensioned size of &quot;data&quot; in rows</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">c -    maxlo = actual dimensioned size of &quot;data&quot; in cols</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">c - data is assumed real*4</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordtype">implicit real*8</span> (a-h,o-z)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordtype">real*4</span> data(maxla,maxlo)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordtype">logical</span> onedlat,onedlon</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">c - HACK </span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c     do 8787 i=1,nla</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">c       do 8788 j=1,nlo</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c         write(6,8789)i,j,data(i,j)</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">c8788   continue</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">c8787 continue</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">c8789 format(i5,1x,i5,1x,f20.10)</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">c - Find the row of xla</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      difla = (xla - glamn) </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      ratla = difla / dla</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      ila = int(ratla)+1</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      gla0 = glamn + (ila-1)*dla</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">c - Find the col of xlo</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      diflo = (xlo - glomn) </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      ratlo = diflo / dlo</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      ilo = int(ratlo)+1</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      glo0 = glomn + (ilo-1)*dlo</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">c - Do the interpolation.  </span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      t=(xlo-glo0)/dlo</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      u=(xla-gla0)/dla</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;     </div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      val = (1.d0-t)*(1.d0-u)*<span class="keyword">data</span>(ila  ,ilo  )  </div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;     *    + (     t)*(1.d0-u)*<span class="keyword">data</span>(ila  ,ilo+1)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;     *    + (     t)*(     u)*<span class="keyword">data</span>(ila+1,ilo+1)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;     *    + (1.d0-t)*(     u)*<span class="keyword">data</span>(ila+1,ilo  )</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">c - HACK</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">return</span>  </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keyword">write</span>(6,198)xla,xlo</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keyword">write</span>(6,200)ila,ilo,gla0,glo0</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keyword">write</span>(6,199)xla-gla0,xlo-glo0</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keyword">write</span>(6,201)ila,ilo,gla0,glo0,</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;     *<span class="keyword">data</span>(ila,ilo)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keyword">write</span>(6,201)ila,ilo+1,gla0,glo0+dlo,</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;     *<span class="keyword">data</span>(ila,ilo+1)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keyword">write</span>(6,201)ila+1,ilo,gla0+dla,glo0,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;     *<span class="keyword">data</span>(ila+1,ilo)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keyword">write</span>(6,201)ila+1,ilo+1,gla0+dla,glo0+dlo,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;     *<span class="keyword">data</span>(ila+1,ilo+1)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keyword">write</span>(6,202)<span class="stringliteral">&#39;SW&#39;</span>,(1.d0-t)*(1.d0-u)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keyword">write</span>(6,202)<span class="stringliteral">&#39;SE&#39;</span>,(     t)*(1.d0-u)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keyword">write</span>(6,202)<span class="stringliteral">&#39;NW&#39;</span>,(     t)*(     u)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keyword">write</span>(6,202)<span class="stringliteral">&#39;NE&#39;</span>,(1.d0-t)*(     u)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  202 <span class="keyword">format</span>(</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;     *<span class="stringliteral">&#39;Weight to &#39;</span>,a,<span class="stringliteral">&#39; corner = &#39;</span>,f20.15)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  198 <span class="keyword">format</span>(</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;     *6x,<span class="stringliteral">&#39;bilin.f: lat/lon = &#39;</span>,f10.6,1x,f10.6)</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  199 <span class="keyword">format</span>(</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;     *6x,<span class="stringliteral">&#39;bilin.f: diff from SW corner of cell = &#39;</span>,f10.6,1x,f10.6)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  200 <span class="keyword">format</span>(</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;     *6x,<span class="stringliteral">&#39;bilin.f: SW corner: &#39;</span>,i6,1x,i6,1x,f10.6,1x,f10.6)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  201 <span class="keyword">format</span>(</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;     *6x,2(i6,1x),2(f10.6,1x),f20.15)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">c     write(6,801)xla,xlo,ila,ilo,gla0,glo0,t,u,val</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  801 <span class="keyword">format</span>(f15.8,1x,f15.8,1x,i6,1x,i6,1x,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;     *f15.8,1x,f15.8,1x,f8.6,1x,f8.6,1x,f20.10)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">c     write(6,802)data(ila  ,ilo  ),</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">c    *data(ila  ,ilo+1),data(ila+1,ilo+1),</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">c    *data(ila+1,ilo  )</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  802 <span class="keyword">format</span>(4(f15.8,1x))</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      </div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">return</span></div></div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gaf9228c4b11b96e50bee68421e66ed412_icgraph.svg" width="183" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gab451c989dfed05b90b17f4005dd5133a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine biquad </td>
          <td>(</td>
          <td class="paramtype">real*4, dimension(maxla,maxlo)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>glamn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>glomn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to perform a 2-D quadratic ("biquadratic") interpolation. </p>
<p>Performs a biquadratic interpolation at location <code>xla,xlo</code> off of grid <code>z</code>, whose header information is the standard ".b" header information</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Input Grid </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glamn</td><td>minimum latitude (real*8 decimal degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">glomn</td><td>minimum longitude (real*8 decimal degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dla</td><td>latitude spacing (real*8 decimal degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dlo</td><td>longitude spacing (real*8 decimal degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nla</td><td>number of lat rows (integer*4) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nlo</td><td>number of lon cols (integer*4) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxla</td><td>actual dimensioned size of "z" in rows </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxlo</td><td>actual dimensioned size of "z" in cols </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xla</td><td>lat of pt for interpolation (real*8 dec. deg) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xlo</td><td>lon of pt for interpolation (real*8 dec. deg) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">val</td><td>interpolated value (real*8)</td></tr>
  </table>
  </dd>
</dl>
<h3>Method:</h3>
<p>Fit a 3x3 window over the random point. The closest 2x2 points will surround the point. But based on which quadrant of that 2x2 cell in which the point falls, the 3x3 window could extend NW, NE, SW or SE from the 2x2 cell. </p>

<p>Definition at line <a class="el" href="biquad_8f_source.html#l00033">33</a> of file <a class="el" href="biquad_8f_source.html">biquad.f</a>.</p>

<p>Referenced by <a class="el" href="checkgrid_8f_source.html#l00100">checkgrid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">c - Subroutine to perform a 2-D quadratic (&quot;biquadratic&quot;)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">c - interpolation at location &quot;xla,xlo&quot; off of grid &quot;z&quot;, whose</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">c - header information is the standard &quot;.b&quot; header</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">c - information of</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">c -    glamn = minimum latitude   (real*8 decimal degrees)</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">c -    glomn = minimum longitude  (real*8 decimal degrees)</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">c -    dla   = latitude spacing   (real*8 decimal degrees)</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">c -    dlo   = longitude spacing  (real*8 decimal degrees)</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">c -    nla   = number of lat rows (integer*4)</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">c -    nlo   = number of lon cols (integer*4)</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">c -    maxla = actual dimensioned size of &quot;z&quot; in rows</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">c -    maxlo = actual dimensioned size of &quot;z&quot; in cols</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c - Further input: </span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">c -    xla   = lat of pt for interpolation (real*8 dec. deg)</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c -    xlo   = lon of pt for interpolation (real*8 dec. deg)</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">c - Output:</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">c -    val   = interpolated value (real*8)</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">c - </span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">c - Method:</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">c -   Fit a 3x3 window over the random point.  The closest</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">c -   2x2 points will surround the point.  But based on which</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">c -   quadrant of that 2x2 cell in which the point falls, the</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">c -   3x3 window could extend NW, NE, SW or SE from the 2x2 cell.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">c - Data is assumed real*4</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordtype">implicit real*8</span> (a-h,o-z)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordtype">real*4</span> z(maxla,maxlo)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">c - Internal use</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordtype">real*4</span> x,y,fx0,fx1,fx2,<a class="code" href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">c - Find which row should be LEAST when fitting</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">c - a 3x3 window around xla.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      difla = (xla - glamn)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      ratla = difla / (dla/2.d0)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      ila = int(ratla)+1</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">if</span>(mod(ila,2).ne.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        jla = (ila+1)/2 - 1</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        jla = (ila  )/2</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">c - Fix any edge overlaps</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordflow">if</span>(jla.lt.1)jla = 1</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">if</span>(jla.gt.nla-2)jla = nla-2</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">c - Find which column should be LEAST when fitting</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">c - a 3x3 window around xlo.</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      diflo = (xlo - glomn)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      ratlo = diflo / (dlo/2.d0)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      ilo = int(ratlo)+1</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">if</span>(mod(ilo,2).ne.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        jlo = (ilo+1)/2 - 1</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        jlo = (ilo  )/2</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">c - Fix any edge overlaps</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">if</span>(jlo.lt.1)jlo = 1</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">if</span>(jlo.gt.nlo-2)jlo = nlo-2</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">c - In the range of 0(westernmost) to</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">c - 2(easternmost) col, where is our</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">c - random lon value?  That is, x must</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">c - be real and fall between 0 and 2.</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      x=(xlo-dlo*(jlo-1)-glomn)/dlo</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span>(x.lt.0.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        val = 1.d30</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keyword">write</span>(6,100)x,val</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">c       stop</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  100 <span class="keyword">format</span>(</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;     *<span class="stringliteral">&#39;FATAL in biquad:  x&lt;0 : &#39;</span>,f20.10,/,</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;     *<span class="stringliteral">&#39; --&gt; Returning with val = &#39;</span>,f40.1)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">if</span>(x.gt.2.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        val = 1.d30</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keyword">write</span>(6,101)x,val</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">c       stop</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  101 <span class="keyword">format</span>(</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     *<span class="stringliteral">&#39;FATAL in biquad:  x&gt;2 : &#39;</span>,f20.10,/,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;     *<span class="stringliteral">&#39; --&gt; Returning with val = &#39;</span>,f40.1)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">c - In the range of 0(southernmost) to</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">c - 2(northernmost) row, where is our</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">c - random lat value?  That is, x must</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">c - be real and fall between 0 and 2.</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      y=(xla-dla*(jla-1)-glamn)/dla</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">if</span>(y.lt.0.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        val = 1.d30</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keyword">write</span>(6,102)y,val</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">c       stop</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  102 <span class="keyword">format</span>(</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     *<span class="stringliteral">&#39;FATAL in biquad:  y&lt;0 : &#39;</span>,f20.10,/,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;     *<span class="stringliteral">&#39; --&gt; Returning with val = &#39;</span>,f40.1)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">if</span>(y.gt.2.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        val = 1.d30</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keyword">write</span>(6,103)y,val</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">c       stop</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  103 <span class="keyword">format</span>(</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     *<span class="stringliteral">&#39;FATAL in biquad:  y&gt;2 : &#39;</span>,f20.10,/,</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;     *<span class="stringliteral">&#39; --&gt; Returning with val = &#39;</span>,f40.1)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">c - Now do the interpolation.  First, build a paraboloa</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">c - east-west the southermost row and interpolate to longitude</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">c - &quot;xlo&quot; (at &quot;x&quot; for 0&lt;x&lt;2).  Then do it in the middle</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">c - row, then finally the northern row.  The last step</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">c - is to fit a parabola north-south at the three previous</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">c - interpolations, but this time to interpolate to </span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">c - latitude &quot;xla&quot; (at &quot;y&quot; for 0&lt;y&lt;2).  Obviously we </span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">c - could reverse the order, doing 3 north-south parabolas</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">c - followed by one east-east and we&#39;d get the same answer.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      fx0=<a class="code" href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a>(x,z(jla  ,jlo),z(jla  ,jlo+1),z(jla  ,jlo+2))</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      fx1=<a class="code" href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a>(x,z(jla+1,jlo),z(jla+1,jlo+1),z(jla+1,jlo+2))</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      fx2=<a class="code" href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a>(x,z(jla+2,jlo),z(jla+2,jlo+1),z(jla+2,jlo+2))</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      val=dble(<a class="code" href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a>(y,fx0,fx1,fx2))</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">c     goto 888</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">c     write(6,*) &#39; &#39;</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">c     write(6,*) &#39; ---------------------------------&#39;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">c     write(6,*) &#39; Inside biquad.f&#39;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">c     write(6,*) &#39; &#39;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">c     write(6,*) &#39; Southern Row of 3x3 window: &#39;</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">c     write(6,*) &#39; jla  ,jlo  ,z(jla  ,jlo  ) = &#39;,</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">c    *jla  ,jlo  ,z(jla  ,jlo  )</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">c     write(6,*) &#39; jla  ,jlo+1,z(jla  ,jlo+1) = &#39;,</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">c    *jla  ,jlo+1,z(jla  ,jlo+1)</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">c     write(6,*) &#39; jla  ,jlo+2,z(jla  ,jlo+2) = &#39;,</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">c    *jla  ,jlo+2,z(jla  ,jlo+2)</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">c     write(6,*) &#39; fx0 = &#39;,fx0</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">c     write(6,*) &#39; Middle   Row of 3x3 window: &#39;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">c     write(6,*) &#39; jla+1,jlo  ,z(jla+1,jlo  ) = &#39;,</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">c    *jla+1,jlo  ,z(jla+1,jlo  )</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">c     write(6,*) &#39; jla+1,jlo+1,z(jla+1,jlo+1) = &#39;,</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">c    *jla+1,jlo+1,z(jla+1,jlo+1)</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">c     write(6,*) &#39; jla+1,jlo+2,z(jla+1,jlo+2) = &#39;,</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">c    *jla+1,jlo+2,z(jla+1,jlo+2)</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">c     write(6,*) &#39; fx1 = &#39;,fx1</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">c     write(6,*) &#39; Northern Row of 3x3 window: &#39;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">c     write(6,*) &#39; jla+2,jlo  ,z(jla+2,jlo  ) = &#39;,</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">c    *jla+2,jlo  ,z(jla+2,jlo  )</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">c     write(6,*) &#39; jla+2,jlo+1,z(jla+2,jlo+1) = &#39;,</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">c    *jla+2,jlo+1,z(jla+2,jlo+1)</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">c     write(6,*) &#39; jla+2,jlo+2,z(jla+2,jlo+2) = &#39;,</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">c    *jla+2,jlo+2,z(jla+2,jlo+2)</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">c     write(6,*) &#39; fx2 = &#39;,fx2</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">c     write(6,*) &#39; Final interpolated value = &#39;,val</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">c 888 continue</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_gaa651c892588f1308f29a4b8b02ccd183"><div class="ttname"><a href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a></div><div class="ttdeci">real function qterp(x, f0, f1, f2)</div><div class="ttdoc">This function fits a quadratic function through 3 points. </div><div class="ttdef"><b>Definition:</b> <a href="qterp_8f_source.html#l00051">qterp.f:51</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gab451c989dfed05b90b17f4005dd5133a_icgraph.svg" width="198" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga6d046a9be31aa1d9b69abd6eb6117294"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bwplotcv </td>
          <td>(</td>
          <td class="paramtype">character*3&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>be</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>jm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer*4&#160;</td>
          <td class="paramname"><em>maxplots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>olddtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>newdtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*3&#160;</td>
          <td class="paramname"><em>elecap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>igridsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>fn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to make GMT calls to do a B/W coverage plot. </p>
<h2>Changelog</h2>
<h3>2016 08 29:</h3>
<p>Updated the <code>-R</code> and <code>-B</code> initial calls to 6 decimal places</p>
<h3>2016 08 25:</h3>
<p><code>.gmtdefaults4</code> has been changed so X_ORIGIN is equal to 0.0 Center the plot with "-Xc" at first "psxy" call Remove all "-JM**i+" references, and just use the actual width (jm) that came out of the "getmapbounds" routine and was sent here.</p>
<h3>2016 07 21:</h3>
<p>Modified use of JM command based on new forced sizes.</p>
<h3>2015 02 15:</h3>
<p>Updated to allow this subroutine to work earlier (in <a class="el" href="group__doers.html#gaf6a79a4e301f7aef2eee8c8faf772330" title="Part of the NADCON5 process, generates gmtbat01. ">makeplotfiles01()</a>), before <code>igridsec</code> was defined. See DRU-11, p. 139 </p>

<p>Definition at line <a class="el" href="bwplotcv_8f_source.html#l00030">30</a> of file <a class="el" href="bwplotcv_8f_source.html">bwplotcv.f</a>.</p>

<p>References <a class="el" href="plotcoast_8f_source.html#l00044">plotcoast()</a>.</p>

<p>Referenced by <a class="el" href="makeplotfiles01_8f_source.html#l00058">makeplotfiles01()</a>, <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>, and <a class="el" href="makeplotfiles03_8f_source.html#l00088">makeplotfiles03()</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">c - 2016 08 29:</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">c   Updated the -R and -B initial calls to 6 decimal places      </span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">c - 2016 08 25:</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">c     .gmtdefaults4 has been changed so X_ORIGIN is equal to 0.0</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">c     Center the plot with &quot;-Xc&quot; at first &quot;psxy&quot; call</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">c     Remove all &quot;-JM**i+&quot; references, and just use the actual</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">c       width (jm) that came out of the &quot;getmapbounds&quot; routine and</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">c       was sent here.</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">c - 2016 07 21:</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">c - Modified use of JM command based on new forced sizes.  </span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">c - Subroutine to make GMT calls to do a B/W coverage plot</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c - Updated 10/2/2015 to allow this subroutine to work</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">c - earlier (in makeplotfiles01.f), before &quot;igridsec&quot; was defined.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c - See DRU-11, p. 139</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordtype">integer*4</span> maxplots</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordtype">character*3</span> ele,elecap</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">character*200</span> fname</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordtype">character*10</span> olddtm,newdtm,region</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keywordtype">real*8</span>    bw(maxplots),be(maxplots),bs(maxplots),bn(maxplots)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keywordtype">real*4</span>    jm(maxplots)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordtype">real*4</span> b1(maxplots),b2(maxplots)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordtype">character*10</span> fn(maxplots)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordtype">character*5</span> extra</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordtype">character*20</span> gridnote</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">c - All coverage type files begin with &quot;cv&quot;. </span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">c - The 3rd element tells me all, thinned, dropped or RMS </span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">c - The 4th/5th elements tell me if these are coordinate</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">c - differneces or double differences.  Elements 6,7,8</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">c - tell me what data we&#39;re plotting.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">c - FAILSAFES: BEGIN</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span>(fname(3:3).eq.<span class="stringliteral">&#39;t&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        extra=<span class="stringliteral">&#39;-thin&#39;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">elseif</span>(fname(3:3).eq.<span class="stringliteral">&#39;d&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        extra=<span class="stringliteral">&#39;-drop&#39;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">elseif</span>(fname(3:3).eq.<span class="stringliteral">&#39;a&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        extra=<span class="stringliteral">&#39;-all &#39;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">elseif</span>(fname(3:3).eq.<span class="stringliteral">&#39;r&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        extra=<span class="stringliteral">&#39;-RMSd&#39;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">write</span>(6,1)trim(fname)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        stop</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    1 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotcv.  Bad character in spot 3: &#39;</span>,a)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">if</span>(fname(1:2).ne.<span class="stringliteral">&#39;cv&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">write</span>(6,2)trim(fname)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        stop</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    2 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotcv.  Bad character in spots 1-2: &#39;</span>,a)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">if</span>(.not.(fname(4:5).eq.<span class="stringliteral">&#39;cd&#39;</span> .or. fname(4:5).eq.<span class="stringliteral">&#39;dd&#39;</span>))<span class="keywordflow">then</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">write</span>(6,3)trim(fname)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        stop</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    3 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotcv.  Bad character in spots 4-5: &#39;</span>,a)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">if</span>(fname(6:8).ne.ele)<span class="keywordflow">then</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keyword">write</span>(6,4)trim(fname),ele</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        stop</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    4 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotcv.  Bad match of fname / ele: &#39;</span>,a,1x,a)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">c - Just in case we forgot to set &quot;igridsec&quot; to be -1</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">c - when we came here from makeplotfiles01:</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">if</span>(fname(1:3).eq.<span class="stringliteral">&#39;cvacd&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        igridsec = -1</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">if</span>(igridsec.le.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        gridnote = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">write</span>(gridnote,10)igridsec</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   10 <span class="keyword">format</span>(<span class="stringliteral">&#39;(&#39;</span>,i0,<span class="stringliteral">&#39; sec)&#39;</span>)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">c - FAILSAFES: END</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">c - GMT COMMANDS: BEGIN</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">c - Header of commands/echoes:</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keyword">write</span>(99,991)ele,extra,trim(region),trim(fn(ij)),</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     *ele,extra,trim(region),trim(fn(ij))</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">c - Write out the actual dots, and the title, with PSXY command</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keyword">write</span>(99,904)trim(fname),bw(ij),be(ij),bs(ij),bn(ij),</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;     *jm(ij),b1(ij),b2(ij),trim(newdtm),trim(olddtm),elecap,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;     *extra,trim(gridnote),trim(region),trim(fn(ij))</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">c - ALWAYS plot the coast last, as it closes the PS file</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keyword">call </span><a class="code" href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a>(region,99)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">c - Convert PS to JPG</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keyword">write</span>(99,905)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">c - Rename the JPG to my naming scheme </span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keyword">write</span>(99,910)trim(fname),trim(fn(ij))</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">c - GMT COMMANDS: END</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  991 <span class="keyword">format</span>(</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;     *<span class="stringliteral">&#39;# -----------------------------------------------------&#39;</span>,/,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;     *<span class="stringliteral">&#39;# coverage in &#39;</span>,a,a,1x,a,1x,a,/,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     *<span class="stringliteral">&#39;# -----------------------------------------------------&#39;</span>,/,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     *<span class="stringliteral">&#39;echo ...coverage in &#39;</span>,a,a,1x,a,1x,a)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">c - Plot the actual coverage points</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">c - 2016 08 29</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  904 <span class="keyword">format</span>(<span class="stringliteral">&#39;psxy &#39;</span>,a,<span class="stringliteral">&#39; -Xc -R&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,sp,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;     *  ss,<span class="stringliteral">&#39; -JM&#39;</span>,f3.1,<span class="stringliteral">&#39;i -B&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,<span class="stringliteral">&#39;:.&quot;&#39;</span>,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;     *  <span class="stringliteral">&#39;NADCON v5.0 &#39;</span>,a,<span class="stringliteral">&#39; minus &#39;</span>,a,<span class="stringliteral">&#39; &#39;</span>,a3,a5,a,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;     *  1x,a,<span class="stringliteral">&#39;-&#39;</span>,a,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;     *  <span class="stringliteral">&#39;&quot;: -Sc0.02i &#39;</span>,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;     *  <span class="stringliteral">&#39;-Gblack -K &gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">c - 2016 08 25:</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">c 904 format(&#39;psxy &#39;,a,&#39; -Xc -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,sp,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">c    *  ss,&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,&#39;:.&quot;&#39;,</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">c    *  &#39;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,a5,a,</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">c    *  1x,a,&#39;-&#39;,a,</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">c    *  &#39;&quot;: -Sc0.02i &#39;,</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">c    *  &#39;-Gblack -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">c - 2016 07 21</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">c 904 format(&#39;psxy &#39;,a,&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,sp,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">c    *  ss,&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,&#39;:.&quot;&#39;,</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">c    *  &#39;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,a5,a,</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">c    *  1x,a,&#39;-&#39;,a,</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">c    *  &#39;&quot;: -Sc0.02i &#39;,</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">c    *  &#39;-Gblack -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">c 904 format(&#39;psxy &#39;,a,&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,sp,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">c    *  ss,&#39; -JM&#39;,f3.1,&#39;i+ -B&#39;,f0.2,&#39;/&#39;,f0.2,&#39;:.&quot;&#39;,</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">c    *  &#39;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,a5,a,</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">c    *  1x,a,&#39;-&#39;,a,</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">c    *  &#39;&quot;: -Sc0.02i &#39;,</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">c    *  &#39;-Gblack -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">c - 905 = Convert PS to JPG</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  905 <span class="keyword">format</span>(<span class="stringliteral">&#39;ps2raster plot.ps -Tj -P -A &#39;</span>)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">c - Renaming </span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  910 <span class="keyword">format</span>(<span class="stringliteral">&#39;mv -f plot.jpg &#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.jpg&#39;</span>,/,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;     *<span class="stringliteral">&#39;rm -f plot.ps&#39;</span>)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">c 910 format(&#39;mv -f plot.jpg cv&#39;,a1,a3,&#39;.&#39;,a,&#39;.&#39;,a,&#39;.&#39;,a,</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">c    *&#39;.&#39;,i0,&#39;.&#39;,a,&#39;.jpg&#39;,/,&#39;rm -f plot.ps&#39;)</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; 1910 <span class="keyword">format</span>(<span class="stringliteral">&#39;mv -f plot.jpg cv&#39;</span>,a3,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     *<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.jpg&#39;</span>,/,<span class="stringliteral">&#39;rm -f plot.ps&#39;</span>)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_ga43be1e80c0bde6748f414d2eee05603f"><div class="ttname"><a href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a></div><div class="ttdeci">subroutine plotcoast(region, ifnum)</div><div class="ttdoc">Subroutine to write GMT-based commands to create a shoreline Write GMT-based commands to create a sho...</div><div class="ttdef"><b>Definition:</b> <a href="plotcoast_8f_source.html#l00044">plotcoast.f:44</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga6d046a9be31aa1d9b69abd6eb6117294_cgraph.svg" width="208" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga6d046a9be31aa1d9b69abd6eb6117294_icgraph.svg" width="247" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga82c09d84f1af66481bc8e975f3f986ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bwplotvc </td>
          <td>(</td>
          <td class="paramtype">character*3&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>be</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>jm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer*4&#160;</td>
          <td class="paramname"><em>maxplots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>olddtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>newdtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*3&#160;</td>
          <td class="paramname"><em>elecap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xvlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xvlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xllon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xllat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>lorvog</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>lorvopc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>igridsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>fn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to make GMT calls to do a B/W vector plot. </p>
<h2>Changelog</h2>
<h3>2016 08 29:</h3>
<p>Expanded the refence vector calls to be 6 decimal places, as well as the initial -R call for S/N/W/E and also the -B part of that call</p>
<h3>2016 08 25:</h3>
<p><code>.gmtdefaults4</code> has been changed so X_ORIGIN is equal to 0.0 Center the plot with "-Xc" at first "psxy" call Remove all "-JM**i+" references, and just use the actual width (jm) that came out of the "getmapbounds" routine and was sent here.</p>
<h3>2016 07 29:</h3>
<p>Updated the reference vector call to have the "-N" option, so it'll plot outside the map</p>
<h3>2016 07 21:</h3>
<p>Modified use of JM command based on new forced sizes.</p>
<h3>2015 02 15:</h3>
<p>Updated to allow this subroutine to work earlier (in <a class="el" href="group__doers.html#gaf6a79a4e301f7aef2eee8c8faf772330" title="Part of the NADCON5 process, generates gmtbat01. ">makeplotfiles01()</a>), before <code>igridsec</code> was defined. See DRU-11, p. 139 </p>

<p>Definition at line <a class="el" href="bwplotvc_8f_source.html#l00037">37</a> of file <a class="el" href="bwplotvc_8f_source.html">bwplotvc.f</a>.</p>

<p>References <a class="el" href="plotcoast_8f_source.html#l00044">plotcoast()</a>.</p>

<p>Referenced by <a class="el" href="checkgrid_8f_source.html#l00100">checkgrid()</a>, <a class="el" href="makeplotfiles01_8f_source.html#l00058">makeplotfiles01()</a>, <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>, and <a class="el" href="makeplotfiles03_8f_source.html#l00088">makeplotfiles03()</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">c - 2016 08 29:</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">c     Expanded the refence vector calls to be 6 decimal places, as well</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">c     as the initial -R call for S/N/W/E</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">c     and also the -B part of that call</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">c - 2016 08 25:</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">c     .gmtdefaults4 has been changed so X_ORIGIN is equal to 0.0</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">c     Center the plot with &quot;-Xc&quot; at first &quot;psxy&quot; call</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c     Remove all &quot;-JM**i+&quot; references, and just use the actual</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">c       width (jm) that came out of the &quot;getmapbounds&quot; routine and</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c       was sent here.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">c - 2016 07 29:  Updated the reference vector call to </span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">c - have the &quot;-N&quot; option, so it&#39;ll plot outside the map</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">c - 2016 07 21:  Updated JM usage for new forced sizes</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">c     subroutine bwplotvc(ele,fname,bw,be,bs,bn,jm,b1,b2,maxplots,</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">c    *olddtm,newdtm,region,elecap,ij,xvlon,xvlat,xllon,xllat,ncm,</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">c    *q1,igridsec,fn)</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">c - Subroutine to make GMT calls to do a B/W vector plot</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">c - Updated 10/2/2015 to allow this subroutine to work</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">c - earlier (in makeplotfiles01.f), before &quot;igridsec&quot; was defined.</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">c - See DRU-11, p. 139</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">implicit real*8</span>(a-h,o-z)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordtype">integer*4</span> maxplots</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordtype">character*3</span> ele,elecap</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordtype">character*200</span> fname</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordtype">character*10</span> olddtm,newdtm,region</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">real*8</span>    bw(maxplots),be(maxplots),bs(maxplots),bn(maxplots)</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordtype">real*4</span>    jm(maxplots)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordtype">real*4</span> b1(maxplots),b2(maxplots)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordtype">character*10</span> fn(maxplots)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordtype">character*5</span> extra</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordtype">character*20</span> units</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keywordtype">character*20</span> gridnote</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordtype">character*20</span> gridnote2</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordtype">real*8</span> lorvopc,lorvog</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">c - All vector  type files begin with either &quot;vm&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">c - (meters) or &quot;vs&quot; (arcseconds).</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">c - The 3rd element tells me all, thinned, dropped or RMS</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">c - The 4th/5th elements tell me if these are coordinate</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">c - differnces or double differences.  Elements 6,7,8</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">c - tell me what data we&#39;re plotting.</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">c - FAILSAFES: BEGIN</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keywordflow">if</span>(fname(3:3).eq.<span class="stringliteral">&#39;t&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        extra=<span class="stringliteral">&#39;-thin&#39;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">elseif</span>(fname(3:3).eq.<span class="stringliteral">&#39;d&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        extra=<span class="stringliteral">&#39;-drop&#39;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">elseif</span>(fname(3:3).eq.<span class="stringliteral">&#39;a&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        extra=<span class="stringliteral">&#39;-all &#39;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">elseif</span>(fname(3:3).eq.<span class="stringliteral">&#39;r&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        extra=<span class="stringliteral">&#39;-RMSd&#39;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keyword">write</span>(6,1)trim(fname)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        stop</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    1 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotvc.  Bad character in spot 3: &#39;</span>,a)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span>(.not.(fname(1:2).eq.<span class="stringliteral">&#39;vm&#39;</span>.or.fname(1:2).eq.<span class="stringliteral">&#39;vs&#39;</span>))<span class="keywordflow">then</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keyword">write</span>(6,2)trim(fname)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        stop</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    2 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotvc.  Bad character in spots 1-2: &#39;</span>,a)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">if</span>(.not.(fname(4:5).eq.<span class="stringliteral">&#39;cd&#39;</span> .or. fname(4:5).eq.<span class="stringliteral">&#39;dd&#39;</span> .or.</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;     *         fname(4:5).eq.<span class="stringliteral">&#39;gi&#39;</span>))<span class="keywordflow">then</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keyword">write</span>(6,3)trim(fname)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        stop</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    3 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotvc.  Bad character in spots 4-5: &#39;</span>,a)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span>(fname(6:8).ne.ele)<span class="keywordflow">then</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keyword">write</span>(6,4)trim(fname),ele</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        stop</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    4 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotvc.  Bad match of fname / ele: &#39;</span>,a,1x,a)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">c - Just in case we forgot to set &quot;igridsec&quot; to be -1</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">c - when we came here from makeplotfiles01:</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">if</span>(fname(1:3).eq.<span class="stringliteral">&#39;vmacd&#39;</span> .or. fname(1:3).eq.<span class="stringliteral">&#39;vsacd&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        igridsec = -1</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">if</span>    (fname(2:2).eq.<span class="stringliteral">&#39;m&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        units=<span class="stringliteral">&#39;meters&#39;</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">elseif</span>(fname(2:2).eq.<span class="stringliteral">&#39;s&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        units=<span class="stringliteral">&#39;arcseconds&#39;</span> </div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keyword">write</span>(6,5)trim(fname)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        stop</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    5 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in bwplotvc.  Bad units in name: &#39;</span>,a)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordflow">if</span>(igridsec.le.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        gridnote = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        gridnote2 = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">write</span>(gridnote,10)igridsec</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keyword">write</span>(gridnote2,11)igridsec</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   10 <span class="keyword">format</span>(<span class="stringliteral">&#39;(&#39;</span>,i0,<span class="stringliteral">&#39; sec)&#39;</span>)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   11 <span class="keyword">format</span>(i0,<span class="stringliteral">&#39;.&#39;</span>)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">c - FAILSAFES: END</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">c - GMT COMMANDS: BEGIN</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">c - Header of commands/echoes:</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keyword">write</span>(99,991)ele,extra,trim(units),trim(region),trim(fn(ij)),</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;     *ele,extra,trim(units),trim(region),trim(fn(ij))</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">c - Plot the actual vectors, and the title, with PSXY command</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keyword">write</span>(99,903)trim(fname),bw(ij),be(ij),bs(ij),bn(ij),</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;     *jm(ij),b1(ij),b2(ij),trim(newdtm),trim(olddtm),elecap,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;     *extra,trim(gridnote),trim(region),trim(fn(ij)),fname(2:5)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">c - Plot the reference vector</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keyword">write</span>(99,908)xvlon,xvlat,90.d0,lorvopc</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">c     write(99,908)xvlon,xvlat,90.d0,q1</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">c - Label the reference vector</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">c - HACK</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">c     write(6,807)trim(fname),trim(units)</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">c 807 format(&#39;File: &#39;,a,/,&#39;Units: &#39;,a)</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">if</span>    (trim(units).eq.<span class="stringliteral">&#39;arcseconds&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keyword">write</span>(99,1909)xllon,xllat,lorvog,trim(units)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">elseif</span>(trim(units).eq.<span class="stringliteral">&#39;meters&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keyword">write</span>(99, 909)xllon,xllat,lorvog,trim(units)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">c - ALWAYS plot the coast last, as it closes the PS file</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">call </span><a class="code" href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a>(region,99)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">c - Convert PS to JPG</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keyword">write</span>(99,905)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">c - Rename the JPG to my naming scheme</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">c     write(99,906)trim(fname),trim(gridnote2),trim(fn(ij))</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keyword">write</span>(99,906)trim(fname),trim(fn(ij))</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">c - GMT COMMANDS: END</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  991 <span class="keyword">format</span>(</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     *<span class="stringliteral">&#39;# -----------------------------------------------------&#39;</span>,/,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;     *<span class="stringliteral">&#39;# vectors in &#39;</span>,a,a,1x,a,1x,a,1x,a,/,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;     *<span class="stringliteral">&#39;# -----------------------------------------------------&#39;</span>,/,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     *<span class="stringliteral">&#39;echo ...vectors in &#39;</span>,a,a,1x,a,1x,a,1x,a)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">c - Plot the actual vectors</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">c - 2016 08 29</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  903 <span class="keyword">format</span>(<span class="stringliteral">&#39;psxy &#39;</span>,a,<span class="stringliteral">&#39; -Xc -R&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,sp,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     *  ss,<span class="stringliteral">&#39; -JM&#39;</span>,f3.1,<span class="stringliteral">&#39;i -B&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,<span class="stringliteral">&#39;:.&quot;&#39;</span>,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     *  <span class="stringliteral">&#39;NADCON v5.0 &#39;</span>,a,<span class="stringliteral">&#39; minus &#39;</span>,a,<span class="stringliteral">&#39; &#39;</span>,a3,a5,a,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     *  1x,a,<span class="stringliteral">&#39;-&#39;</span>,a,1x,a,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     *<span class="stringliteral">&#39;&quot;: -SV0.0001i/0.02i/0.02i &#39;</span>,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     *  <span class="stringliteral">&#39;-Gblack -K &gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">c - 2016 08 25:</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">c 903 format(&#39;psxy &#39;,a,&#39; -Xc -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,sp,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">c    *  ss,&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,&#39;:.&quot;&#39;,</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">c    *  &#39;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,a5,a,</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">c    *  1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">c    *&#39;&quot;: -SV0.0001i/0.02i/0.02i &#39;,</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">c    *  &#39;-Gblack -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">c 903 format(&#39;psxy &#39;,a,&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,sp,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">c    *  ss,&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,&#39;:.&quot;&#39;,</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">c    *  &#39;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,a5,a,</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">c    *  1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">c    *&#39;&quot;: -SV0.0001i/0.02i/0.02i &#39;,</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">c    *  &#39;-Gblack -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">c 903 format(&#39;psxy &#39;,a,&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,sp,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">c    *  ss,&#39; -JM&#39;,f3.1,&#39;i+ -B&#39;,f0.2,&#39;/&#39;,f0.2,&#39;:.&quot;&#39;,</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">c    *  &#39;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,a5,a,</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">c    *  1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">c    *&#39;&quot;: -SV0.0001i/0.02i/0.02i &#39;,</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">c    *  &#39;-Gblack -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">c - 908 = Plot a REFERENCE vector</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">c - 2016 08 29:  More decimal places</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  908 <span class="keyword">format</span>(<span class="stringliteral">&#39;psxy -SV0.0001i/0.02i/0.02i -N -R -O -K -JM&#39;</span>,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;     *  <span class="stringliteral">&#39; -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;</span>,/,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;     *  f10.6,1x,f10.6,1x,f5.1,1x,f9.1,/,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;     *  <span class="stringliteral">&#39;!&#39;</span>)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">c - 2016 07 29:  Make reference vector appear outside of map</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">c 908 format(&#39;psxy -SV0.0001i/0.02i/0.02i -N -R -O -K -JM&#39;,</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">c    *  &#39; -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;,/,</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">c    *  f6.2,1x,f6.2,1x,f5.1,1x,f9.1,/,</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">c    *  &#39;!&#39;)</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">c 908 format(&#39;psxy -SV0.0001i/0.02i/0.02i -R -O -K -JM&#39;,</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">c    *  &#39; -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;,/,</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">c    *  f6.2,1x,f6.2,1x,f5.1,1x,f9.1,/,</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">c    *  &#39;!&#39;)</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">c - 909 = Label the REFERENCE vector</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">c - 2016 08 29:  More decimal places</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  909 <span class="keyword">format</span>(<span class="stringliteral">&#39;pstext -N -O -K -R -JM -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;</span>,/,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;     *  f10.6,1x,f10.6,1x,<span class="stringliteral">&#39;12 0 1 TL &#39;</span>,f10.3,1x,a,/,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;     *  <span class="stringliteral">&#39;!&#39;</span>)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">c - 2016 07 29:  Use -N to plot it outside</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">c 909 format(&#39;pstext -N -O -K -R -JM -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;,/,</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">c    *  f6.2,1x,f6.2,1x,&#39;12 0 1 TL &#39;,f10.3,1x,a,/,</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">c    *  &#39;!&#39;)</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">c - 2016 08 29:  More decimal places</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; 1909 <span class="keyword">format</span>(<span class="stringliteral">&#39;pstext -N -O -K -R -JM -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;</span>,/,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     *  f10.6,1x,f10.6,1x,<span class="stringliteral">&#39;12 0 1 TL &#39;</span>,f10.6,1x,a,/,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;     *  <span class="stringliteral">&#39;!&#39;</span>)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">c1909 format(&#39;pstext -N -O -K -R -JM -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;,/,</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">c    *  f6.2,1x,f6.2,1x,&#39;12 0 1 TL &#39;,f10.6,1x,a,/,</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">c    *  &#39;!&#39;)</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">c 909 format(&#39;pstext -O -K -R -JM -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;,/,</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">c    *  f6.2,1x,f6.2,1x,&#39;12 0 1 TL &#39;,f10.3,1x,a,/,</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">c    *  &#39;!&#39;)</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">c1909 format(&#39;pstext -O -K -R -JM -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;,/,</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">c    *  f6.2,1x,f6.2,1x,&#39;12 0 1 TL &#39;,f10.6,1x,a,/,</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">c    *  &#39;!&#39;)</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">c 909 format(&#39;pstext -O -K -R -JM -Gred &gt;&gt; plot.ps &lt;&lt; !&#39;,/,</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">c    *  f6.2,1x,f6.2,1x,&#39;12 0 1 TL &#39;,i6,&#39; cm&#39;,/,</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">c    *  &#39;!&#39;)</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">c - 905 = Convert PS to JPG</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  905 <span class="keyword">format</span>(<span class="stringliteral">&#39;ps2raster plot.ps -Tj -P -A &#39;</span>)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">c - Rename to our naming scheme</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">c 906 format(&#39;mv -f plot.jpg &#39;,a,</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">c    *&#39;.&#39;,a,a,&#39;.jpg&#39;,/,&#39;rm -f plot.ps&#39;)</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  906 <span class="keyword">format</span>(<span class="stringliteral">&#39;mv -f plot.jpg &#39;</span>,a,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;     *<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.jpg&#39;</span>,/,<span class="stringliteral">&#39;rm -f plot.ps&#39;</span>)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_ga43be1e80c0bde6748f414d2eee05603f"><div class="ttname"><a href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a></div><div class="ttdeci">subroutine plotcoast(region, ifnum)</div><div class="ttdoc">Subroutine to write GMT-based commands to create a shoreline Write GMT-based commands to create a sho...</div><div class="ttdef"><b>Definition:</b> <a href="plotcoast_8f_source.html#l00044">plotcoast.f:44</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga82c09d84f1af66481bc8e975f3f986ae_cgraph.svg" width="208" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga82c09d84f1af66481bc8e975f3f986ae_icgraph.svg" width="247" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga53b9c3b6c272c62581749a8c6e89eb3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program convlv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Convolves two grids. </p>
<p>Convolves one grid against another </p><p class="formulaDsp">
\[ c(i,j) = a(i,j) * b(i,j) \]
</p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infileA</td><td>First Input File Name </td></tr>
    <tr><td class="paramname">infileB</td><td>Second Input File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name of A*B</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin1</code> Input File A</li>
<li><code>lin2</code> Input File B</li>
<li><code>lout</code> Output File to Write A+B </li>
</ul>

<p>Definition at line <a class="el" href="convlv_8f_source.html#l00029">29</a> of file <a class="el" href="convlv_8f_source.html">convlv.f</a>.</p>

</div>
</div>
<a class="anchor" id="ga44465308a9701d8ffe256715e4f01215"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine coplot </td>
          <td>(</td>
          <td class="paramtype">character*3&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>be</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>jm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer*4&#160;</td>
          <td class="paramname"><em>maxplots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>olddtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>newdtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*3&#160;</td>
          <td class="paramname"><em>elecap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cptlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cpthi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cptin6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>suffixused</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>igridsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>fn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to make GMT calls to do Color Raster Rendering of Gridded Data. </p>
<h2>Changelog</h2>
<h3>2016 09 08:</h3>
<p>Had to up the D_FORMAT default to %.3G because tight scalebar ranges with the newly allowed "more free" average values were showing repeating values when only 2 digits could be shown.</p>
<h3>2016 09 07:</h3>
<p>Had to add lines pre/post "makecpt" to change the D_FORMAT. This is because I <em>had</em> been forcing the "scave" in <a class="el" href="cpt_8f.html">cpt.f</a> to be ONZD. But that yielded bad values sometimes, so I switched it. With that switch, the scave could have lots of digits. Well, that means the newly adopted "D_FORMAT" of %.2G was insufficient for the CPT table. Who knew that D_FORMAT affected that! Anyway, so change "D_FORMAT" pre/post all makecpt calls.</p>
<h3>2016 08 30:</h3>
<p>See item #39 in Google ToDo list Changed "grdcontour" to have a blank "-R" call so it'll mimic whatever decimal places are in the "grdimage" call that came before it.</p>
<h3>2016 08 29:</h3>
<p>Updated the initial -R and -B calls to 6 decimal places</p>
<h3>2016 08 25:</h3>
<p>-.gmtdefaults4 has been changed so X_ORIGIN is equal to 0.0</p><ul>
<li>Center the plot with "-Xc" at grdimage</li>
<li>Center the scalebar by setting its Xcoordinate, which runs in "plot frame" coordinates (0/0 at lower left) , to be equal to "jm/2"</li>
<li>Force the scale bar to be exactly 4 inches wide, always</li>
<li>Change the format for "makecpt" from 0.6 to 0.10</li>
</ul>
<h3>2016 07 29:</h3>
<p>Update to put more data into comment/echo</p>
<p>Also,</p><ul>
<li>forced the -Ctemp.cpt option in "grdcontour" to make the contours line up with the color palette</li>
<li>For d3 plots, to drop all contours</li>
<li>For d3 plots to only use "coverage" part <em>only</em> if "ij" is not "1"</li>
<li>Same for "09" and "ete" grids</li>
</ul>
<h3>2016 07 21:</h3>
<ul>
<li>Set the "JM" code in "grdcontour" to just be "-JM" and let it therefore run with whatever JM size is used in "grdimage"</li>
<li>Set the "A" code in "grdcontour" to be "-A-" which should turn off the labels on all contours</li>
<li>Fixed size of scale bar</li>
</ul>
<h3>2016 03 01:</h3>
<ol type="1">
<li>Changed to a continuous color plot<ul>
<li>Get rid of "-Z" in "makecpt"</li>
</ul>
</li>
<li>Changed to an 8 color, from 6 color, plot (without changing the RANGE yet...see DRU-12, p. 19)<ul>
<li>Change varible that comes in from "cptin" to "cptin6"</li>
<li>Compute cptin = cptin6 * 0.75d0 immediately</li>
</ul>
</li>
</ol>
<h3>Update 2016 02 29:</h3>
<ol type="1">
<li>Removed all shading from color plots<ul>
<li>Get rid of "grdgradient" call</li>
<li>Remove from "grdimage" the "-Itempi.grd" part</li>
<li>Remove the "rm -f tempi.grd" line </li>
</ul>
</li>
</ol>

<p>Definition at line <a class="el" href="coplot_8f_source.html#l00074">74</a> of file <a class="el" href="coplot_8f_source.html">coplot.f</a>.</p>

<p>References <a class="el" href="plotcoast_8f_source.html#l00044">plotcoast()</a>.</p>

<p>Referenced by <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>, and <a class="el" href="makeplotfiles03_8f_source.html#l00088">makeplotfiles03()</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">c - 2016 09 08</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">c   Had to up the D_FORMAT default to %.3G because tight scalebar ranges</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">c   with the newly allowed &quot;more free&quot; average values were showing</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">c   repeating values when only 2 digits could be shown.</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">c - 2016 09 07</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">c    Had to add lines pre/post &quot;makecpt&quot; to change the D_FORMAT.  This is because</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">c    I *had* been forcing the &quot;scave&quot; in cpt.f to be ONZD.  But that yielded</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">c    bad values sometimes, so I switched it.  With that switch, the scave could</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">c    have lots of digits.  Well, that means the newly adopted &quot;D_FORMAT&quot; of %.2G</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">c    was insufficient for the CPT table.  Who knew that D_FORMAT affected that!</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">c    Anyway, so change &quot;D_FORMAT&quot; pre/post all makecpt calls.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">c - 2016 08 30:  See item #39 in Google ToDo list</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">c     Changed &quot;grdcontour&quot; to have a blank &quot;-R&quot; call so it&#39;ll mimic whatever</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">c     decimal places are in the &quot;grdimage&quot; call that came before it.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">c - 2016 08 29:</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">c     Updated the initial -R and -B calls to 6 decimal places</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">c - 2016 08 25:</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">c     .gmtdefaults4 has been changed so X_ORIGIN is equal to 0.0</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">c     Center the plot with &quot;-Xc&quot; at grdimage</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">c     Center the scalebar by setting its Xcoordinate, which runs in &quot;plot frame&quot;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">c       coordinates (0/0 at lower left) , to be equal to &quot;jm/2&quot; </span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">c     Force the scale bar to be exactly 4 inches wide, always</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">c     Change the format for &quot;makecpt&quot; from 0.6 to 0.10</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">c - 2016 07 29:</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">c     Update to put more data into comment/echo</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">c     Also forced the -Ctemp.cpt option in &quot;grdcontour&quot; to make the contours line up with the color palette</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">c     For d3 plots, to drop all contours</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">c     For d3 plots to only use &quot;coverage&quot; part *only* if &quot;ij&quot; is not &quot;1&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">c     Same for &quot;09&quot; and &quot;ete&quot; grids</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">c     subroutine coplot(ele,fname,bw,be,bs,bn,jm,b1,b2,maxplots,</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">c    *olddtm,newdtm,region,elecap,ij,cptlo,cpthi,cptin,suffixused,</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">c    *igridsec,fn)</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">c - Update 2016 07 21:</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">c   - Set the &quot;JM&quot; code in &quot;grdcontour&quot; to just be &quot;-JM&quot; and let it therefore </span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">c     run with whatever JM size is used in &quot;grdimage&quot;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">c   - Set the &quot;A&quot; code in &quot;grdcontour&quot; to be &quot;-A-&quot; which should turn off </span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">c     the labels on all contours</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">c   - Fixed size of scale bar</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">c - Update 2016 03 01:</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">c    - 1) Changed to a continuous color plot</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">c         * Get rid of &quot;-Z&quot; in &quot;makecpt&quot;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">c      2) Changed to an 8 color, from 6 color, plot (without changing the RANGE yet...see DRU-12, p. 19)</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">c         * Change varible that comes in from &quot;cptin&quot; to &quot;cptin6&quot;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">c         * Compute cptin = cptin6 * 0.75d0 immediately</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">c - Update 2016 02 29:</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">c    - 1) Removed all shading from color plots</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">c         * Get rid of &quot;grdgradient&quot; call</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">c         * Remove from &quot;grdimage&quot; the &quot;-Itempi.grd&quot; part</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">c         * Remove the &quot;rm -f tempi.grd&quot; line</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">c     subroutine coplot(ele,fname,bw,be,bs,bn,jm,b1,b2,maxplots,</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">c    *olddtm,newdtm,region,elecap,ij,cptlo,cpthi,cptin,suffix2,</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">c    *igridsec,fn)</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">c     subroutine coplot(ele,fname,bw,be,bs,bn,jm,b1,b2,maxplots,</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">c    *olddtm,newdtm,region,elecap,ij,ave,std,suffix2,igridsec,fn)</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">implicit real*8</span>(a-h,o-z)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">c - Subroutine to make GMT calls to do a color raster rendering</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">c - of gridded data</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">integer*4</span> maxplots</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">character*3</span> ele,elecap</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordtype">character*200</span> fname</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">character*10</span> olddtm,newdtm,region</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordtype">real*8</span>    bw(maxplots),be(maxplots),bs(maxplots),bn(maxplots)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordtype">real*4</span>    jm(maxplots)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">real*4</span> b1(maxplots),b2(maxplots)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordtype">character*10</span> fn(maxplots)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordtype">real*8</span> ave,std</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordtype">character*200</span> suffixused</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordtype">character*20</span> units</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordtype">character*20</span> gridnote</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordtype">character*20</span> gridnote2</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">c - FAILSAFES: BEGIN</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">if</span>(.not.(fname(1:3).eq.<span class="stringliteral">&#39;vmt&#39;</span>.or.fname(1:3).eq.<span class="stringliteral">&#39;vst&#39;</span> .or.</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;     *         fname(1:3).eq.<span class="stringliteral">&#39;vmr&#39;</span>.or.fname(1:3).eq.<span class="stringliteral">&#39;vsr&#39;</span> .or.</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;     *         fname(1:3).eq.<span class="stringliteral">&#39;vme&#39;</span>.or.fname(1:3).eq.<span class="stringliteral">&#39;vse&#39;</span>))<span class="keywordflow">then</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keyword">write</span>(6,2)trim(fname)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        stop</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    2 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplot.  Bad character in spots 1-3: &#39;</span>,a)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">if</span>(.not.(fname(4:5).eq.<span class="stringliteral">&#39;cd&#39;</span> .or. fname(4:5).eq.<span class="stringliteral">&#39;dd&#39;</span> .or.</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     *         fname(4:5).eq.<span class="stringliteral">&#39;te&#39;</span> ))<span class="keywordflow">then</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keyword">write</span>(6,3)trim(fname)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        stop</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    3 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplot.  Bad character in spots 4-5: &#39;</span>,a)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">if</span>(fname(6:8).ne.ele)<span class="keywordflow">then</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keyword">write</span>(6,4)trim(fname),ele</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        stop</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    4 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplot.  Bad match of fname / ele: &#39;</span>,a,1x,a)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">if</span>(fname(2:2).eq.<span class="stringliteral">&#39;m&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        units=<span class="stringliteral">&#39;meters&#39;</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">elseif</span>(fname(2:2).eq.<span class="stringliteral">&#39;s&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        units=<span class="stringliteral">&#39;arcseconds&#39;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keyword">write</span>(6,5)trim(fname)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        stop</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    5 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplot.  Bad units in name: &#39;</span>,a)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">if</span>(igridsec.le.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keyword">write</span>(6,6)igridsec</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keyword">write</span>(gridnote,10)igridsec</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keyword">write</span>(gridnote2,11)igridsec</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    6 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplot.  Bad igridsec: &#39;</span>,i0)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   10 <span class="keyword">format</span>(<span class="stringliteral">&#39;(&#39;</span>,i0,<span class="stringliteral">&#39; sec)&#39;</span>)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   11 <span class="keyword">format</span>(i0,<span class="stringliteral">&#39;.&#39;</span>)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">c - FAILSAFES: END</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">c - Contour interval and labeling</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">c - 2016 07 29:  Just use cptin6 as it came in</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      cptin = cptin6</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">c - Begin 2016 03 01</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">c     cptin = cptin6 * 0.75d0 </span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">c - End 2016 03 01</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      conin = cptin</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      conlb = conin / 2.d0</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">c - GMT COMMANDS: BEGIN</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">c - Header of commands/echoes:</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">c - 2016 07 29:</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keyword">write</span>(99,991)ele,trim(units),trim(region),trim(fn(ij)),</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;     *trim(suffixused),</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;     *ele,trim(units),trim(region),trim(fn(ij)),</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;     *trim(suffixused)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">c     write(99,991)ele,trim(units),trim(region),trim(fn(ij)),</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">c    *ele,trim(units),trim(region),trim(fn(ij))</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">c - GMT call to create the color palette:</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">c - Store the palette as file &quot;temp.cpt&quot;, to be</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">c - deleted later.</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keyword">write</span>(99,901)cptlo,cpthi,cptin</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">c - Begin 2016 03 01:</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">c 901 format(</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">c    *&#39;makecpt -Crainbow -T&#39;,f0.6,&#39;/&#39;,f0.6,&#39;/&#39;,f0.6,</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">c    *&#39; -Z &gt; temp.cpt&#39;)</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">c 901 format(</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">c    *&#39;makecpt -Crainbow -T&#39;,f0.6,&#39;/&#39;,f0.6,&#39;/&#39;,f0.6,</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">c    *&#39; &gt; temp.cpt&#39;)</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">c - 2016 08 25</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">c 901 format(</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">c    *&#39;makecpt -Crainbow -T&#39;,f0.10,&#39;/&#39;,f0.10,&#39;/&#39;,f0.10,</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">c    *&#39; &gt; temp.cpt&#39;)</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">c - 2016 09 07</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">c 901 format(</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">c    *&#39;gmtset D_FORMAT %.12G&#39;,/,</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">c    *&#39;makecpt -Crainbow -T&#39;,f0.10,&#39;/&#39;,f0.10,&#39;/&#39;,f0.10,</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">c    *&#39; &gt; temp.cpt&#39;,/,</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">c    *&#39;gmtset D_FORMAT %.2G&#39;)</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">c - 2016 09 08</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  901 <span class="keyword">format</span>(</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;     *<span class="stringliteral">&#39;gmtset D_FORMAT %.12G&#39;</span>,/,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     *<span class="stringliteral">&#39;makecpt -Crainbow -T&#39;</span>,f0.10,<span class="stringliteral">&#39;/&#39;</span>,f0.10,<span class="stringliteral">&#39;/&#39;</span>,f0.10,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     *<span class="stringliteral">&#39; &gt; temp.cpt&#39;</span>,/,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;     *<span class="stringliteral">&#39;gmtset D_FORMAT %.3G&#39;</span>)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">c - GMT call to create the gradient file from</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">c - the &quot;grd&quot; formatted version of our input grid.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">c - Store the gradients as file &quot;tempi.grd&quot; to be</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">c - deleted later.</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">c - Updated 2016 02 29:</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">c     write(99,902)fname(1:8),trim(suffixused)</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  902 <span class="keyword">format</span>(</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     *<span class="stringliteral">&#39;grdgradient &#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     *<span class="stringliteral">&#39;.grd -N4.8 -A90 -M -Gtempi.grd&#39;</span>)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">c - Until here 2016 02 29</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">c - GMT call to create the color render of the</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">c - gridded data.   Store as file &quot;plot.ps&quot;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">c - to be deleted later.</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keyword">write</span>(99,903)fname(1:8),trim(suffixused),</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     *bw(ij),be(ij),bs(ij),bn(ij),</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     *jm(ij),b1(ij),b2(ij),</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;     *trim(newdtm),trim(olddtm),elecap,igridsec,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;     *trim(region),trim(fn(ij)),fname(2:5)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">c - Commented this out for 2016 03 01:</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">c 903 format(</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">c    *&#39;grdimage &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">c    *&#39; -Ei -Itempi.grd&#39;,</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">c    *&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">c    *&#39;:.&quot;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">c    *&#39;(&#39;,i0,&#39; sec)&#39;,</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">c    *1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">c    *&#39;:&quot; -Ctemp.cpt -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">c 903 format(</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">c    *&#39;grdimage &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">c    *&#39; -Ei &#39;,</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">c    *&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">c    *&#39;:.&quot;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">c    *&#39;(&#39;,i0,&#39; sec)&#39;,</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">c    *1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">c    *&#39;:&quot; -Ctemp.cpt -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">c - Below for 2016 08 25:</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">c 903 format(</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">c    *&#39;grdimage &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">c    *&#39; -Ei -Xc&#39;,</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">c    *&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">c    *&#39;:.&quot;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">c    *&#39;(&#39;,i0,&#39; sec)&#39;,</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">c    *1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">c    *&#39;:&quot; -Ctemp.cpt -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">c - 2016 08 29:</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  903 <span class="keyword">format</span>(</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;     *<span class="stringliteral">&#39;grdimage &#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.grd&#39;</span>,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;     *<span class="stringliteral">&#39; -Ei -Xc&#39;</span>,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;     *<span class="stringliteral">&#39; -R&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;     *<span class="stringliteral">&#39; -JM&#39;</span>,f3.1,<span class="stringliteral">&#39;i -B&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;     *<span class="stringliteral">&#39;:.&quot;NADCON v5.0 &#39;</span>,a,<span class="stringliteral">&#39; minus &#39;</span>,a,<span class="stringliteral">&#39; &#39;</span>,a3,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;     *<span class="stringliteral">&#39;(&#39;</span>,i0,<span class="stringliteral">&#39; sec)&#39;</span>,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;     *1x,a,<span class="stringliteral">&#39;-&#39;</span>,a,1x,a,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;     *<span class="stringliteral">&#39;:&quot; -Ctemp.cpt -K &gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">c - GMT call to put a color scale on the map.  Add it</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">c - to file &quot;plot.ps&quot;.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">c - 2016 07 21</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">c     write(99,904)trim(units)</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">c     qqa = jm(ij) - 1.d0</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">c     qqb = qqa / 2.d0</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">c     write(99,904)qqb,qqa,trim(units)</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">c - 2016 08 25</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      qqa = jm(ij)/2</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keyword">write</span>(99,904)qqa,trim(units)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  904 <span class="keyword">format</span>(</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;     *<span class="stringliteral">&#39;psscale -D&#39;</span>,f3.1,<span class="stringliteral">&#39;i/-0.4i/4.0i/0.2ih&#39;</span>,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;     *<span class="stringliteral">&#39; -Ctemp.cpt -I0.4 -B/:&#39;</span>,a,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;     *<span class="stringliteral">&#39;: -O -K &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">c 904 format(</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">c    *&#39;psscale -D4i/-0.4i/8i/0.2ih -Ctemp.cpt -I0.4 -B/:&#39;,a,</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">c    *&#39;: -O -K &gt;&gt; plot.ps&#39;)</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">c - GMT call to put contours on the map.</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">c - 2016 07 29</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">c - 2016 07 21</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">c 2016 07 29:  skip contours if this is a d3, 09 or &quot;ete&quot; plot</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      ll = len(trim(suffixused))</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">if</span>(suffixused(ll-1:ll).eq.<span class="stringliteral">&#39;d3&#39;</span>)<span class="keywordflow">goto</span> 807</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span>(suffixused(ll-1:ll).eq.<span class="stringliteral">&#39;09&#39;</span>)<span class="keywordflow">goto</span> 807</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">if</span>(fname(3:5).eq.<span class="stringliteral">&#39;ete&#39;</span>)<span class="keywordflow">goto</span> 807</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keyword">write</span>(99,908)fname(1:8),trim(suffixused)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">c     write(99,908)fname(1:8),trim(suffixused),</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">c    *bw(ij),be(ij),bs(ij),bn(ij)</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">c     write(99,908)fname(1:8),trim(suffixused),conin,</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">c    *bw(ij),be(ij),bs(ij),bn(ij)</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">c     write(99,908)fname(1:8),trim(suffixused),conin,</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">c    *bw(ij),be(ij),bs(ij),bn(ij),</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">c    *jm(ij),conlb</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">c - 2016 08 30:</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  908 <span class="keyword">format</span>(</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;     *<span class="stringliteral">&#39;grdcontour &#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.grd&#39;</span>,</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;     *<span class="stringliteral">&#39; -Ctemp.cpt&#39;</span>,</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;     *<span class="stringliteral">&#39; -R&#39;</span>,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;     *<span class="stringliteral">&#39; -JM -Wthin&#39;</span>,</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;     *<span class="stringliteral">&#39; -A- -O -K &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">c - 2016 07 29</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">c 908 format(</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">c    *&#39;grdcontour &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">c    *&#39; -Ctemp.cpt&#39;,</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">c    *&#39; -JM -Wthin&#39;,</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">c    *&#39; -A- -O -K &gt;&gt; plot.ps&#39;)</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">c - 2016 07 21</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">c 908 format(</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">c    *&#39;grdcontour &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">c    *&#39; -C&#39;,f0.5,</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">c    *&#39; -JM -Wthin&#39;,</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">c    *&#39; -A- -O -K &gt;&gt; plot.ps&#39;)</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">c 908 format(</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">c    *&#39;grdcontour &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">c    *&#39; -C&#39;,f0.5,</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">c    *&#39; -JM&#39;,f3.1,&#39;i -Wthin&#39;,</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">c    *&#39; -A&#39;,f0.5,&#39; -O -K &gt;&gt; plot.ps&#39;)</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">c - 2016 07 28 - Skip to here (skipping contours) for d3, 09 or &quot;ete&quot;  plots</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  807 <span class="keywordflow">continue</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">c - GMT call to create the shoreline.  Add it to</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">c - file &quot;plot.ps&quot;.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">c - ALWAYS plot the coast last, as it closes the PS file</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keyword">call </span><a class="code" href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a>(region,99)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">c - GMT call to convert the plot.ps file to plot.jpg.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keyword">write</span>(99,905)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  905 <span class="keyword">format</span>(</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;     *<span class="stringliteral">&#39;ps2raster plot.ps -Tj -P -A&#39;</span>)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">c - Change name of JPG to its final name:</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keyword">write</span>(99,906)fname(2:8),trim(suffixused),trim(fn(ij))</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  906 <span class="keyword">format</span>(<span class="stringliteral">&#39;mv plot.jpg c&#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.jpg&#39;</span>)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">c - Remove all the temporary files</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keyword">write</span>(99,907)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">c - Update 2016 02 29:</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">c 907 format(</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">c    *&#39;rm -f temp.cpt&#39;,/,</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">c    *&#39;rm -f tempi.grd&#39;,/,</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">c    *&#39;rm -f plot.ps&#39;)</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  907 <span class="keyword">format</span>(</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;     *<span class="stringliteral">&#39;rm -f temp.cpt&#39;</span>,/,</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;     *<span class="stringliteral">&#39;rm -f plot.ps&#39;</span>)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">c - Until here 2016 02 29</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">c - 2016 07 29:</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  991 <span class="keyword">format</span>(</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;     *<span class="stringliteral">&#39;# -----------------------------------------------------&#39;</span>,/,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;     *<span class="stringliteral">&#39;# color plots in &#39;</span>,a,1x,a,1x,a,1x,a,1x,<span class="stringliteral">&#39; Grid:&#39;</span>,a /,</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;     *<span class="stringliteral">&#39;# -----------------------------------------------------&#39;</span>,/,</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;     *<span class="stringliteral">&#39;echo ...color plots in &#39;</span>,a,1x,a,1x,a,1x,a,1x,<span class="stringliteral">&#39; Grid:&#39;</span>,a)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">c 991 format(</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">c    *&#39;# -----------------------------------------------------&#39;,/,</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">c    *&#39;# color plots in &#39;,a,1x,a,1x,a,1x,a,/,</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">c    *&#39;# -----------------------------------------------------&#39;,/,</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">c    *&#39;echo ...color plots in &#39;,a,1x,a,1x,a,1x,a)</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_ga43be1e80c0bde6748f414d2eee05603f"><div class="ttname"><a href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a></div><div class="ttdeci">subroutine plotcoast(region, ifnum)</div><div class="ttdoc">Subroutine to write GMT-based commands to create a shoreline Write GMT-based commands to create a sho...</div><div class="ttdef"><b>Definition:</b> <a href="plotcoast_8f_source.html#l00044">plotcoast.f:44</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga44465308a9701d8ffe256715e4f01215_cgraph.svg" width="191" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga44465308a9701d8ffe256715e4f01215_icgraph.svg" width="230" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gacc3bebf5d61250a63b6d444e4514ad88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine coplotwcv </td>
          <td>(</td>
          <td class="paramtype">character*3&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>be</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>jm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer*4&#160;</td>
          <td class="paramname"><em>maxplots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>olddtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>newdtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*3&#160;</td>
          <td class="paramname"><em>elecap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cptlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cpthi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cptin6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>suffixused</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>igridsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>cvfname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to make GMT calls to do a color raster rendering of gridded data, with coverage overlaid. </p>
<h2>Changelog</h2>
<h3>2016 09 08:</h3>
<p>Had to up the D_FORMAT default to %.3G because tight scalebar ranges with the newly allowed "more free" average values were showing repeating values when only 2 digits could be shown.</p>
<h3>2016 09 07:</h3>
<p>Had to add lines pre/post "makecpt" to change the D_FORMAT. This is because I <em>had</em> been forcing the "scave" in <a class="el" href="cpt_8f.html">cpt.f</a> to be ONZD. But that yielded bad values sometimes, so I switched it. With that switch, the scave could have lots of digits. Well, that means the newly adopted "D_FORMAT" of %.2G was insufficient for the CPT table. Who knew that D_FORMAT affected that! Anyway, so change "D_FORMAT" pre/post all makecpt calls.</p>
<h3>2016 08 30:</h3>
<p>See item #39 in Google ToDo list Changed "grdcontour" to have a blank "-R" call so it'll mimic whatever decimal places are in the "grdimage" call that came before it.</p>
<h3>2016 08 29:</h3>
<p>Updated the initial -R and -B calls to 6 decimal places</p>
<h3>2016 08 25:</h3>
<ul>
<li>.gmtdefaults4 has been changed so X_ORIGIN is equal to 0.0</li>
<li>Center the plot with "-Xc" at grdimage</li>
<li>Center the scalebar by setting its Xcoordinate, which runs in "plot frame" coordinates (0/0 at lower left) , to be equal to "jm/2"</li>
<li>Force the scale bar to be exactly 4 inches wide, always</li>
<li>Change the format for "makecpt" from 0.6 to 0.10</li>
</ul>
<h3>2016 07 29:</h3>
<ul>
<li>Update to put more data into comment/echo</li>
<li>Forced grdcontour with -Ctemp.cpt to align contours with color palette</li>
</ul>
<h3>2016 07 28:</h3>
<ul>
<li>For d3 plots, to drop all contours</li>
<li>For d3 plots to only use "coverage" part <em>only</em> if "ij" is not "1"</li>
<li>Same for "09" and "ete" grids</li>
</ul>
<h3>2016 07 21:</h3>
<ul>
<li>Set the "JM" code in "grdcontour" to just be "-JM" and let it therefore run with whatever JM size is used in "grdimage"</li>
<li>Set the "A" code in "grdcontour" to be "-A-" which should turn off the labels on all contours</li>
<li>Fixed the size of the scale bar</li>
</ul>
<h3>2016 03 01:</h3>
<ol type="1">
<li>Changed to a continuous color plot<ul>
<li>Get rid of "-Z" in "makecpt"</li>
</ul>
</li>
<li>Changed to an 8 color, from 6 color, plot (without changing the RANGE yet...see DRU-12, p. 19)<ul>
<li>Change varible that comes in from "cptin" to "cptin6"</li>
<li>Compute cptin = cptin6 * 0.75d0 immediately</li>
</ul>
</li>
</ol>
<h3>2016 02 29:</h3>
<ol type="1">
<li>Removed all shading from color plots<ul>
<li>Get rid of "grdgradient" call</li>
<li>Remove from "grdimage" the "-Itempi.grd" part</li>
<li>Remove the "rm -f tempi.grd" line </li>
</ul>
</li>
</ol>

<p>Definition at line <a class="el" href="coplotwcv_8f_source.html#l00072">72</a> of file <a class="el" href="coplotwcv_8f_source.html">coplotwcv.f</a>.</p>

<p>References <a class="el" href="plotcoast_8f_source.html#l00044">plotcoast()</a>.</p>

<p>Referenced by <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">c - 2016 09 08</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">c   Had to up the D_FORMAT default to %.3G because tight scalebar ranges</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">c   with the newly allowed &quot;more free&quot; average values were showing</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">c   repeating values when only 2 digits could be shown.</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">c - 2016 09 07</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">c    Had to add lines pre/post &quot;makecpt&quot; to change the D_FORMAT.  This is because</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">c    I *had* been forcing the &quot;scave&quot; in cpt.f to be ONZD.  But that yielded</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">c    bad values sometimes, so I switched it.  With that switch, the scave could</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">c    have lots of digits.  Well, that means the newly adopted &quot;D_FORMAT&quot; of %.2G</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">c    was insufficient for the CPT table.  Who knew that D_FORMAT affected that!</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">c    Anyway, so change &quot;D_FORMAT&quot; pre/post all makecpt calls.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">c - 2016 08 30:  See item #39 in Google ToDo list</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">c     Changed &quot;grdcontour&quot; to have a blank &quot;-R&quot; call so it&#39;ll mimic whatever</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">c     decimal places are in the &quot;grdimage&quot; call that came before it.</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">c - 2016 08 29:</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">c     Updated the initial -R and -B calls to 6 decimal places</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">c - 2016 08 25:</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">c     .gmtdefaults4 has been changed so X_ORIGIN is equal to 0.0</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">c     Center the plot with &quot;-Xc&quot; at grdimage</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">c     Center the scalebar by setting its Xcoordinate, which runs in &quot;plot frame&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">c       coordinates (0/0 at lower left) , to be equal to &quot;jm/2&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">c     Force the scale bar to be exactly 4 inches wide, always</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">c     Change the format for &quot;makecpt&quot; from 0.6 to 0.10</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">c - 2016 07 29: </span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">c     Update to put more data into comment/echo      </span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">c -   Forced grdcontour with -Ctemp.cpt to align contours with color palette</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">c - Update 2016 07 28 to:</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">c     For d3 plots, to drop all contours</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">c     For d3 plots to only use &quot;coverage&quot; part *only* if &quot;ij&quot; is not &quot;1&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">c     Same for &quot;09&quot; and &quot;ete&quot; grids</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">c     subroutine coplotwcv(ele,fname,bw,be,bs,bn,jm,b1,b2,maxplots,</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">c    *olddtm,newdtm,region,elecap,ij,cptlo,cpthi,cptin,suffixused,</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">c    *igridsec,fn,cvfname)</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">c - Update 2016 07 21:</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">c   - Set the &quot;JM&quot; code in &quot;grdcontour&quot; to just be &quot;-JM&quot; and let it therefore </span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">c     run with whatever JM size is used in &quot;grdimage&quot;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">c   - Set the &quot;A&quot; code in &quot;grdcontour&quot; to be &quot;-A-&quot; which should turn off </span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">c     the labels on all contours</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">c   - Fixed the size of the scale bar</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">c - Update 2016 03 01:</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">c    - 1) Changed to a continuous color plot</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">c         * Get rid of &quot;-Z&quot; in &quot;makecpt&quot;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">c      2) Changed to an 8 color, from 6 color, plot (without changing the RANGE yet...see DRU-12, p. 19)</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">c         * Change varible that comes in from &quot;cptin&quot; to &quot;cptin6&quot;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">c         * Compute cptin = cptin6 * 0.75d0 immediately</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">c - Update 2016 02 29:</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">c    - 1) Removed all shading from color plots </span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">c         * Get rid of &quot;grdgradient&quot; call</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">c         * Remove from &quot;grdimage&quot; the &quot;-Itempi.grd&quot; part</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">c         * Remove the &quot;rm -f tempi.grd&quot; line</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">c  </span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordtype">implicit real*8</span>(a-h,o-z)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">c - Subroutine to make GMT calls to do a color raster rendering</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">c - of gridded data, with coverage overlaid.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordtype">integer*4</span> maxplots</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordtype">character*3</span> ele,elecap</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">character*200</span> fname,cvfname</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordtype">character*10</span> olddtm,newdtm,region</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordtype">real*8</span>    bw(maxplots),be(maxplots),bs(maxplots),bn(maxplots)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">real*4</span>    jm(maxplots)</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordtype">real*4</span> b1(maxplots),b2(maxplots)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">character*10</span> fn(maxplots)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordtype">real*8</span> ave,std</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">character*200</span> suffixused</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordtype">character*20</span> units</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordtype">character*20</span> gridnote</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">character*20</span> gridnote2</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">c - FAILSAFES: BEGIN</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">if</span>(.not.(fname(1:3).eq.<span class="stringliteral">&#39;vmt&#39;</span>.or.fname(1:3).eq.<span class="stringliteral">&#39;vst&#39;</span> .or.</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;     *         fname(1:3).eq.<span class="stringliteral">&#39;vmr&#39;</span>.or.fname(1:3).eq.<span class="stringliteral">&#39;vsr&#39;</span>))<span class="keywordflow">then</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keyword">write</span>(6,2)trim(fname)</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        stop</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    2 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplotwcv.  Bad character in spots 1-3: &#39;</span>,a)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">if</span>(.not.(fname(4:5).eq.<span class="stringliteral">&#39;cd&#39;</span> .or. fname(4:5).eq.<span class="stringliteral">&#39;dd&#39;</span>))<span class="keywordflow">then</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keyword">write</span>(6,3)trim(fname)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        stop</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    3 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplotwcv.  Bad character in spots 4-5: &#39;</span>,a)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">if</span>(fname(6:8).ne.ele)<span class="keywordflow">then</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">write</span>(6,4)trim(fname),ele</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        stop</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    4 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplotwcv.  Bad match of fname / ele: &#39;</span>,a,1x,a)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">if</span>(fname(2:2).eq.<span class="stringliteral">&#39;m&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        units=<span class="stringliteral">&#39;meters&#39;</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">elseif</span>(fname(2:2).eq.<span class="stringliteral">&#39;s&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        units=<span class="stringliteral">&#39;arcseconds&#39;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keyword">write</span>(6,5)trim(fname)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        stop</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    5 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplotwcv.  Bad units in name: &#39;</span>,a)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span>(igridsec.le.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keyword">write</span>(6,6)igridsec</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keyword">write</span>(gridnote,10)igridsec</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keyword">write</span>(gridnote2,11)igridsec</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    6 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in coplotwcv.  Bad igridsec: &#39;</span>,i0)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   10 <span class="keyword">format</span>(<span class="stringliteral">&#39;(&#39;</span>,i0,<span class="stringliteral">&#39; sec)&#39;</span>)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   11 <span class="keyword">format</span>(i0,<span class="stringliteral">&#39;.&#39;</span>)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">c - FAILSAFES: END</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">c ----------------------------------------------------</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">c - Contour interval and labeling</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">c ------------------------------------------------------------------</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">c - 2016 07 28:  Scrapped the whole thing about scaling cptin.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">c - Just bring in the interval for an 8 color spread, period.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      cptin = cptin6</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">c - 2016 03 01:</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">c     cptin = cptin6 * 0.75d0</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">c - End 2016 03 01</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      conin = cptin</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      conlb = conin / 2.d0</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">c - GMT COMMANDS: BEGIN</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">c ----------------------------------------------</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">c - Header of commands/echoes:</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">c - 2016 07 29:</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">write</span>(99,991)ele,trim(units),trim(region),trim(fn(ij)),</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;     *trim(suffixused),</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;     *ele,trim(units),trim(region),trim(fn(ij)),</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     *trim(suffixused)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">c     write(99,991)ele,trim(units),trim(region),trim(fn(ij)),</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">c    *ele,trim(units),trim(region),trim(fn(ij))</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">c - GMT call to create the color palette:</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">c - Store the palette as file &quot;temp.cpt&quot;, to be</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">c - deleted later.</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keyword">write</span>(99,901)cptlo,cpthi,cptin</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">c - Begin 2016 03 01:</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">c 901 format(</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">c    *&#39;makecpt -Crainbow -T&#39;,f0.6,&#39;/&#39;,f0.6,&#39;/&#39;,f0.6,</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">c    *&#39; -Z &gt; temp.cpt&#39;)</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">c 901 format(</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">c    *&#39;makecpt -Crainbow -T&#39;,f0.6,&#39;/&#39;,f0.6,&#39;/&#39;,f0.6,</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">c    *&#39; &gt; temp.cpt&#39;)</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">c - 2016 08 25</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">c 901 format(</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">c    *&#39;makecpt -Crainbow -T&#39;,f0.10,&#39;/&#39;,f0.10,&#39;/&#39;,f0.10,</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">c    *&#39; &gt; temp.cpt&#39;)</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">c - 2016 09 07</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">c 901 format(</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">c    *&#39;gmtset D_FORMAT %.12G&#39;,/,</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">c    *&#39;makecpt -Crainbow -T&#39;,f0.10,&#39;/&#39;,f0.10,&#39;/&#39;,f0.10,</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">c    *&#39; &gt; temp.cpt&#39;,/,</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">c    *&#39;gmtset D_FORMAT %.2G&#39;)</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">c - 2016 09 07</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  901 <span class="keyword">format</span>(</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;     *<span class="stringliteral">&#39;gmtset D_FORMAT %.12G&#39;</span>,/,</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;     *<span class="stringliteral">&#39;makecpt -Crainbow -T&#39;</span>,f0.10,<span class="stringliteral">&#39;/&#39;</span>,f0.10,<span class="stringliteral">&#39;/&#39;</span>,f0.10,</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;     *<span class="stringliteral">&#39; &gt; temp.cpt&#39;</span>,/,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;     *<span class="stringliteral">&#39;gmtset D_FORMAT %.3G&#39;</span>)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">c - GMT call to create the gradient file from</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">c - the &quot;grd&quot; formatted version of our input grid.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">c - Store the gradients as file &quot;tempi.grd&quot; to be</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">c - deleted later.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">c - Updated 2016 02 29:</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">c     write(99,902)fname(1:8),trim(suffixused)</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  902 <span class="keyword">format</span>(</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;     *<span class="stringliteral">&#39;grdgradient &#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     *<span class="stringliteral">&#39;.grd -N4.8 -A90 -M -Gtempi.grd&#39;</span>)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">c - Until here 2016 02 29</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">c - GMT call to create the color render of the</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">c - gridded data.   Store as file &quot;plot.ps&quot;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">c - to be deleted later.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keyword">write</span>(99,903)fname(1:8),trim(suffixused),</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     *bw(ij),be(ij),bs(ij),bn(ij),</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     *jm(ij),b1(ij),b2(ij),</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     *trim(newdtm),trim(olddtm),elecap,igridsec,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     *trim(region),trim(fn(ij)),<span class="stringliteral">&#39;method noise&#39;</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">c - Commented out for 2016 02 29:</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">c 903 format(</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">c    *&#39;grdimage &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">c    *&#39; -Ei -Itempi.grd&#39;,</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">c    *&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">c    *&#39;:.&quot;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">c    *&#39;(&#39;,i0,&#39; sec)&#39;,</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">c    *1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">c    *&#39;:&quot; -Ctemp.cpt -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">c - Commented out for 2016 03 01:</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">c 903 format(</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">c    *&#39;grdimage &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">c    *&#39; -Ei &#39;,</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">c    *&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">c    *&#39;:.&quot;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">c    *&#39;(&#39;,i0,&#39; sec)&#39;,</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">c    *1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">c    *&#39;:&quot; -Ctemp.cpt -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">c - Below for 2016 08 25:</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">c 903 format(</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">c    *&#39;grdimage &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">c    *&#39; -Ei -Xc&#39;,</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">c    *&#39; -JM&#39;,f3.1,&#39;i -B&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">c    *&#39;:.&quot;NADCON v5.0 &#39;,a,&#39; minus &#39;,a,&#39; &#39;,a3,</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">c    *&#39;(&#39;,i0,&#39; sec)&#39;,</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">c    *1x,a,&#39;-&#39;,a,1x,a,</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">c    *&#39;:&quot; -Ctemp.cpt -K &gt; plot.ps&#39;)</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">c - 2016 08 29:</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  903 <span class="keyword">format</span>(</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;     *<span class="stringliteral">&#39;grdimage &#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.grd&#39;</span>,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;     *<span class="stringliteral">&#39; -Ei -Xc&#39;</span>,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;     *<span class="stringliteral">&#39; -R&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;     *<span class="stringliteral">&#39; -JM&#39;</span>,f3.1,<span class="stringliteral">&#39;i -B&#39;</span>,f0.6,<span class="stringliteral">&#39;/&#39;</span>,f0.6,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;     *<span class="stringliteral">&#39;:.&quot;NADCON v5.0 &#39;</span>,a,<span class="stringliteral">&#39; minus &#39;</span>,a,<span class="stringliteral">&#39; &#39;</span>,a3,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;     *<span class="stringliteral">&#39;(&#39;</span>,i0,<span class="stringliteral">&#39; sec)&#39;</span>,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;     *1x,a,<span class="stringliteral">&#39;-&#39;</span>,a,1x,a,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;     *<span class="stringliteral">&#39;:&quot; -Ctemp.cpt -K &gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">c - GMT call to put a color scale on the map.  Add it</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">c - to file &quot;plot.ps&quot;.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">c - 2016 07 21:</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">c     qqa = jm(ij) - 1.d0</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">c     qqb = qqa / 2.d0</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">c     write(99,904)qqb,qqa,trim(units)</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">c - 2016 08 25</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      qqa = jm(ij)/2</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keyword">write</span>(99,904)qqa,trim(units)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  904 <span class="keyword">format</span>(</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     *<span class="stringliteral">&#39;psscale -D&#39;</span>,f3.1,<span class="stringliteral">&#39;i/-0.4i/4.0i/0.2ih&#39;</span>,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;     *<span class="stringliteral">&#39; -Ctemp.cpt -I0.4 -B/:&#39;</span>,a,</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;     *<span class="stringliteral">&#39;: -O -K &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">c     write(99,904)trim(units)</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">c 904 format(</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">c    *&#39;psscale -D4i/-0.4i/8i/0.2ih -Ctemp.cpt -I0.4 -B/:&#39;,a,</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">c    *&#39;: -O -K &gt;&gt; plot.ps&#39;)</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">c - GMT call to put contours on the map.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">c - 2016 07 28...skip contours if this is a d3, 09 or &quot;ete&quot; plot</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      ll = len(trim(suffixused))</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordflow">if</span>(suffixused(ll-1:ll).eq.<span class="stringliteral">&#39;d3&#39;</span>)<span class="keywordflow">goto</span> 807</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">if</span>(suffixused(ll-1:ll).eq.<span class="stringliteral">&#39;09&#39;</span>)<span class="keywordflow">goto</span> 807</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">if</span>(fname(3:5).eq.<span class="stringliteral">&#39;ete&#39;</span>)<span class="keywordflow">goto</span> 807</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">c - 2016 08 30:</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keyword">write</span>(99,908)fname(1:8),trim(suffixused)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">c - 2016 07 29:</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">c     write(99,908)fname(1:8),trim(suffixused),</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">c    *bw(ij),be(ij),bs(ij),bn(ij)</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">c - 2016 07 21:</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">c     write(99,908)fname(1:8),trim(suffixused),conin,</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">c    *bw(ij),be(ij),bs(ij),bn(ij)</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">c     write(99,908)fname(1:8),trim(suffixused),conin,</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">c    *bw(ij),be(ij),bs(ij),bn(ij),</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">c    *jm(ij),conlb</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">c - 2016 08 30</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  908 <span class="keyword">format</span>(</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;     *<span class="stringliteral">&#39;grdcontour &#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.grd&#39;</span>,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     *<span class="stringliteral">&#39; -Ctemp.cpt&#39;</span>,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;     *<span class="stringliteral">&#39; -R&#39;</span>,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;     *<span class="stringliteral">&#39; -JM -Wthin&#39;</span>,</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;     *<span class="stringliteral">&#39; -A- -O -K &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">c - 2016 07 29:</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">c 908 format(</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">c    *&#39;grdcontour &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">c    *&#39; -Ctemp.cpt&#39;,</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">c    *&#39; -JM -Wthin&#39;,</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">c    *&#39; -A- -O -K &gt;&gt; plot.ps&#39;)</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">c - 2016 07 21:</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">c 908 format(</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">c    *&#39;grdcontour &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">c    *&#39; -C&#39;,f0.5,</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">c    *&#39; -JM -Wthin&#39;,</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">c    *&#39; -A- -O -K &gt;&gt; plot.ps&#39;)</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">c 908 format(</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">c    *&#39;grdcontour &#39;,a,&#39;.&#39;,a,&#39;.grd&#39;,</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">c    *&#39; -C&#39;,f0.5,</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">c    *&#39; -R&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,&#39;/&#39;,f0.2,</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">c    *&#39; -JM&#39;,f3.1,&#39;i -Wthin&#39;,</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">c    *&#39; -A&#39;,f0.5,&#39; -O -K &gt;&gt; plot.ps&#39;)</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">c - 2016 07 28 - Skip to here (skipping contours) for d3, 09 or &quot;ete&quot; plots</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  807 <span class="keywordflow">continue</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">c - 2016 07 28 - Skip the coverage if this is a &quot;d3&quot; plot, 09 plot or &quot;ete&quot; plot *and*</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">c - we are at the overall map level of 1 (&quot;entire&quot;)</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">if</span>(suffixused(ll-1:ll).eq.<span class="stringliteral">&#39;d3&#39;</span> .and. ij.eq.1)<span class="keywordflow">goto</span> 808</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">if</span>(suffixused(ll-1:ll).eq.<span class="stringliteral">&#39;09&#39;</span> .and. ij.eq.1)<span class="keywordflow">goto</span> 808</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">if</span>(fname(3:5).eq.<span class="stringliteral">&#39;ete&#39;</span> .and. ij.eq.1)<span class="keywordflow">goto</span> 808</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">c - GMT call to overlay the coverage</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keyword">write</span>(99,909)trim(cvfname)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  909 <span class="keyword">format</span>(</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;     *<span class="stringliteral">&#39;psxy &#39;</span>,a,<span class="stringliteral">&#39; -R -J -Sc0.02i -Gblack -O -K &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  808 <span class="keywordflow">continue</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">c - GMT call to create the shoreline.  Add it to</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">c - file &quot;plot.ps&quot;.</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">c - ALWAYS plot the coast last, as it closes the PS file</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keyword">call </span><a class="code" href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a>(region,99)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">c - GMT call to convert the plot.ps file to plot.jpg.</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keyword">write</span>(99,905)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  905 <span class="keyword">format</span>(</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;     *<span class="stringliteral">&#39;ps2raster plot.ps -Tj -P -A&#39;</span>)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">c - Change name of JPG to its final name:</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keyword">write</span>(99,906)fname(2:8),trim(suffixused),trim(fn(ij))</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  906 <span class="keyword">format</span>(<span class="stringliteral">&#39;mv plot.jpg c&#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.&#39;</span>,a,<span class="stringliteral">&#39;.jpg&#39;</span>)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">c - Remove all the temporary files</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keyword">write</span>(99,907)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">c - Updated 2016 02 29:</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">c 907 format(</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">c    *&#39;rm -f temp.cpt&#39;,/,</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">c    *&#39;rm -f tempi.grd&#39;,/,</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">c    *&#39;rm -f plot.ps&#39;)</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  907 <span class="keyword">format</span>(</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;     *<span class="stringliteral">&#39;rm -f temp.cpt&#39;</span>,/,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;     *<span class="stringliteral">&#39;rm -f plot.ps&#39;</span>)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">c - Until here 2016 02 29</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  991 <span class="keyword">format</span>(</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;     *<span class="stringliteral">&#39;# -----------------------------------------------------&#39;</span>,/,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;     *<span class="stringliteral">&#39;# color plots with coverage in &#39;</span>,a,1x,a,1x,a,1x,a,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;     *   1x,<span class="stringliteral">&#39; Grid:&#39;</span>,a/,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;     *<span class="stringliteral">&#39;# -----------------------------------------------------&#39;</span>,/,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;     *<span class="stringliteral">&#39;echo ...color plots with coverage in &#39;</span>,a,1x,a,1x,a,1x,a,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;     *  1x,<span class="stringliteral">&#39; Grid:&#39;</span>,a)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">c 991 format(</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">c    *&#39;# -----------------------------------------------------&#39;,/,</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">c    *&#39;# color plots with coverage in &#39;,a,1x,a,1x,a,1x,a,/,</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">c    *&#39;# -----------------------------------------------------&#39;,/,</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">c    *&#39;echo ...color plots with coverage in &#39;,a,1x,a,1x,a,1x,a)</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_ga43be1e80c0bde6748f414d2eee05603f"><div class="ttname"><a href="group__core.html#ga43be1e80c0bde6748f414d2eee05603f">plotcoast</a></div><div class="ttdeci">subroutine plotcoast(region, ifnum)</div><div class="ttdoc">Subroutine to write GMT-based commands to create a shoreline Write GMT-based commands to create a sho...</div><div class="ttdef"><b>Definition:</b> <a href="plotcoast_8f_source.html#l00044">plotcoast.f:44</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gacc3bebf5d61250a63b6d444e4514ad88_cgraph.svg" width="215" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gacc3bebf5d61250a63b6d444e4514ad88_icgraph.svg" width="254" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga0a01789413f4554c379979dc8ef36768"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cpt </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>ave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>csm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine generates the color pallette variables for a GMT color plot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ave</td><td>Average of the gridded data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">std</td><td>Standard deviation of the gridded data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">csm</td><td>Color Sigma Multiplier (how many sigmas on each side of the average do you want the colors to range?) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xlo</td><td>Low value </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xhi</td><td>High value </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xin</td><td>Interval</td></tr>
  </table>
  </dd>
</dl>
<h2>Changelog</h2>
<h3>2016 09 06:</h3>
<p>Modified because the forcing of "scave" to be one non zero digit was throwing off the scalebar so far in Guam that the data in Guam wasn't even plotting. Change to make the interval still be one non zero digit, but then a simpler formula for the scaled average was put in.</p>
<h3>2016 07 29:</h3>
<p>Modified from original version to reflect "new math" invented this week that helps shrink the color bar and/or widen the color bar (see issues 14 and 15 in DRU-12, p. 48) </p>

<p>Definition at line <a class="el" href="cpt_8f_source.html#l00032">32</a> of file <a class="el" href="cpt_8f_source.html">cpt.f</a>.</p>

<p>Referenced by <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">c - 2016 09 06</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">c   Modified because the forcing of &quot;scave&quot; to be one non zero</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">c   digit was throwing off the scalebar so far in Guam that</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">c   the data in Guam wasn&#39;t even plotting.  Change to make</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">c   the interval still be one non zero digit, but then a </span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">c   simpler formula for the scaled average was put in.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">c - 2016 07 29</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">c   Modified from original version to reflect &quot;new math&quot; invented</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">c   this week that helps shrink the color bar and/or widen the</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">c   color bar (see issues 14 and 15 in DRU-12, p. 48)</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordtype">real*8</span> ave,std,csm,xlo,xhi,xin</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordtype">real*8</span> qv,qq,scave</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordtype">integer*4</span> iv,iq</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordtype">real*8</span> spread8,<a class="code" href="group__core.html#gadc5c9acc8aedbc27aa45d5a78980e6d0">onzd2</a></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">c - This subroutine generates the color pallette variables</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">c - for a GMT color plot</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">c - Input:</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">c    ave = Average of the gridded data</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">c    std = Standard deviation of the gridded data</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">c    csm = Color Sigma Multiplier (how many sigmas on each</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">c          side of the average do you want the colors to range?)</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">c - Output:</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">c    xlo = Low value</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">c    xhi = High value</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">c    xin = Interval</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      spread8 = 2 * csm * std / 8.d0</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      xin = <a class="code" href="group__core.html#gadc5c9acc8aedbc27aa45d5a78980e6d0">onzd2</a>(spread8) </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">c     iv = floor(dlog10(std))</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">c     qv = 10.d0**iv</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">c     qq = std / qv</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">c     iq = nint(qq)</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">c - 2016 09 06</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">c     write(6,*) &#39; cpt: ave (pre  onzd2) = &#39;,ave</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">c     scave = onzd2(ave)</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">c     write(6,*) &#39; cpt: ave (post onzd2) = &#39;,ave</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      scave = xin * nint(ave / xin)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">c     xin = iq * qv</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">c     scave = qv * nint(ave/qv)</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">c     xlo = scave - csm*xin</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">c     xhi = scave + csm*xin</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      xlo = scave - 4*xin</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      xhi = scave + 4*xin</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; ---------------------&#39;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: ave      = &#39;</span>,ave</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: std      = &#39;</span>,std</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: csm      = &#39;</span>,csm</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: spread8  = &#39;</span>,spread8</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: targ low = &#39;</span>,ave-csm*std</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: targ high= &#39;</span>,ave+csm*std</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; &#39;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: xin      = &#39;</span>,xin</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: scave    = &#39;</span>,scave</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: xlo      = &#39;</span>,xlo  </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39;cpt: xhi      = &#39;</span>,xhi </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_gadc5c9acc8aedbc27aa45d5a78980e6d0"><div class="ttname"><a href="group__core.html#gadc5c9acc8aedbc27aa45d5a78980e6d0">onzd2</a></div><div class="ttdeci">real *8 function onzd2(x)</div><div class="ttdoc">Function to round a digit to one significant figure (one non zero digit), double precision. </div><div class="ttdef"><b>Definition:</b> <a href="onzd2_8f_source.html#l00036">onzd2.f:36</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga0a01789413f4554c379979dc8ef36768_icgraph.svg" width="212" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gadc3e084679aba567131d58415054bd59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cpt2 </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>med</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>csm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xhi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine generates the color pallette variables for a GMT color plot. </p>
<p>This particular routine is best for data that are all positive, but cluster near a small value while having a lot of outliers to the high-side. The color plot uses the MEDIAN (and a multiplier) to set the upper limit, while forcing the lower limit to be ZERO.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">med</td><td>Median of the gridded data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">csm</td><td>Color Sigma Multiplier (The maximum color range will be based on csm*med. The minimum color range will be zero) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xlo</td><td>Low value </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xhi</td><td>High value </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xin</td><td>Interval </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="cpt2_8f_source.html#l00025">25</a> of file <a class="el" href="cpt2_8f_source.html">cpt2.f</a>.</p>

<p>Referenced by <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>, and <a class="el" href="makeplotfiles03_8f_source.html#l00088">makeplotfiles03()</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordtype">real*8</span> med,csm,xlo,xhi,xin</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordtype">real*8</span> qv,qq,spread,std</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordtype">integer*4</span> iv,iq</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">c - This subroutine generates the color pallette variables</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">c - for a GMT color plot.  This particular routine is best</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">c - for data that are all positive, but cluster near a small</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">c - value while having a lot of outliers to the high-side.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">c - The color plot uses the MEDIAN (and a multiplier) </span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">c - to set the upper limit, while forcing the lower limit</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">c - to be ZERO.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">c - Input:</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">c    med = Median of the gridded data</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">c    csm = Color Sigma Multiplier (The maximum color range will</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">c          be based on csm*med.  The minimum color range will </span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">c          be zero)</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">c - Output:</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">c    xlo = Low value</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">c    xhi = High value</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">c    xin = Interval</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      spread = csm*med</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      std = spread/8.d0</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      iv = floor(dlog10(std))</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      qv = 10.d0**iv</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      qq = std / qv</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      iq = nint(qq)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      xin = iq * qv</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      xlo = 0.d0</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      xhi = 8 * xin</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">return</span></div></div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gadc3e084679aba567131d58415054bd59_icgraph.svg" width="219" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga0d3311b2b903f11603ef30523e7069a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function cubterp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fits a cubic function through four points. </p>
<p>This function fits a cubic function through four <em>equally</em> spaced points along the x-axis at indices 0, 1, 2 and 3. The spacing along the x-axis is "dx"</p>
<p>Thus:</p>
<p class="formulaDsp">
\begin{eqnarray*} f0 = f_0 &amp;= y(x_0) \\ f1 = f_1 &amp;= y(x_1) \\ f2 = f_2 &amp;= y(x_2) \\ f3 = f_3 &amp;= y(x_3) \end{eqnarray*}
</p>
<p>Where:</p>
<p class="formulaDsp">
\begin{eqnarray*} x_1 &amp;= x_0 + dx \\ x_2 &amp;= x_1 + dx \\ x_3 &amp;= x_2 + dx \end{eqnarray*}
</p>
<p>The input value is some value of "x" that falls between 0 and 3. The output value (cubterp) is the cubic function at x.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Compute Interpolation at this positon, a value between 0 and 3 it is scaled relative to <code>x_0</code> <code>x_3</code> and <code>dx</code>. For example, a value of 1.5 is <code>x_0 + 1.5*dx</code> which falls between <code>x1</code> and <code>x2</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f0</td><td><code>y</code> value at <code>x_0</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f1</td><td><code>y</code> value at <code>x_1 = x_0 + dx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f2</td><td><code>y</code> value at <code>x_2 = x_0 + dx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f3</td><td><code>y</code> value at <code>x_3 = x_0 + dx</code>`</td></tr>
  </table>
  </dd>
</dl>
<p>This function uses Newton-Gregory forward polynomial</p>
<p class="formulaDsp">
\begin{eqnarray*} \nabla f_0 &amp;=&amp; f_1 -f_0 \\ \nabla f_1 &amp;=&amp; f_2 -f_1 \\ \nabla^2 f_0 &amp;=&amp; \nabla f_1 - \nabla f_0 \\ cubterp(x, f_0, f_1, f_2, f_3) &amp;=&amp; f_0 + x \nabla f_0 + 0.5 x \left( x-1.0 \right) \nabla^2 f_0 \end{eqnarray*}
</p>
 
<p>Definition at line <a class="el" href="cubterp_8f_source.html#l00052">52</a> of file <a class="el" href="cubterp_8f_source.html">cubterp.f</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">c - x = real*4</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">c - f0,f1,f2,f3 = real*4</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">c - This function fits a cubic function through</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">c - four points, *equally* spaced along the x-axis</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">c - at indices 0, 1, 2 and 3.  The spacing along the</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">c - x-axis is &quot;dx&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">c - Thus:</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">c - </span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">c -    f0 = y(x(0))</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">c -    f1 = y(x(1))</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">c -    f2 = y(x(2))</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">c -    f3 = y(x(3))</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">c -       Where</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">c -       x(1) = x(0) + dx</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">c -       x(2) = x(1) + dx</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">c -       x(3) = x(2) + dx</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">c - The input value is some value of &quot;x&quot; that falls</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">c - between 0 and 3.  The output value (cubterp) is</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">c - the cubic function at x.</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">c - </span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">c - This function uses Newton-Gregory forward polynomial</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">c     df0 =f1 -f0</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">c     df1 =f2 -f1</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">c     d2f0=df1-df0</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">c     qterp=f0 + x*df0 + 0.5*x*(x-1.0)*d2f0</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      df0 = f1 - f0</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      df1 = f2 - f1</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      df2 = f3 - f2</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;     </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      d2f0 = df1 - df0</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      d2f1 = df2 - df1</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      d3f0 = d2f1 - d2f0</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <a class="code" href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a>=f0 + x*df0 + 0.5*x*(x-1.0)*d2f0 </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;     *     +(1.0/6.0)*d3f0*x*(x-1.0)*(x-2.0)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_ga0d3311b2b903f11603ef30523e7069a9"><div class="ttname"><a href="group__core.html#ga0d3311b2b903f11603ef30523e7069a9">cubterp</a></div><div class="ttdeci">real function cubterp(x, f0, f1, f2, f3)</div><div class="ttdoc">This function fits a cubic function through four points. </div><div class="ttdef"><b>Definition:</b> <a href="cubterp_8f_source.html#l00052">cubterp.f:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga61c0f40266dd43c2a77d88c91cb3f6ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program decimate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Extract a reduced (1 of n) dataset. </p>
<p>Decimate - Extract <code>1</code> of every <code>n</code> points</p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>Input File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name </td></tr>
    <tr><td class="paramname">ny</td><td>Latitude Decimation Ratio <code>1:ny</code> </td></tr>
    <tr><td class="paramname">nx</td><td>Longitude Decimation Ratio <code>1:nx</code></td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin</code> Input File A</li>
</ul>
<h3>Program Outputs:</h3>
<ul>
<li><code>lout</code> Output File to Write Decimated File </li>
</ul>

<p>Definition at line <a class="el" href="decimate_8f_source.html#l00029">29</a> of file <a class="el" href="decimate_8f_source.html">decimate.f</a>.</p>

<p>References <a class="el" href="decimate_8f_source.html#l00104">inouti()</a>, and <a class="el" href="decimate_8f_source.html#l00116">inoutr()</a>.</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga61c0f40266dd43c2a77d88c91cb3f6ac_cgraph.svg" width="188" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga4bad06e067b9affa9b0f59cef0adc6ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program gabs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Convert values in a <code>*.b</code> grid to absolute value. </p>
<p>Belongs to the suite of ".b" file manipulators</p>
<p>This program will convert every value in a ".b" grid to its absolute value.</p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>Input File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin</code> Input File (<code>*.b</code> grid)</li>
</ul>
<h3>Program Outputs:</h3>
<ul>
<li><code>lout</code> Output File (<code>*.b</code> grid) </li>
</ul>

<p>Definition at line <a class="el" href="gabs_8f_source.html#l00030">30</a> of file <a class="el" href="gabs_8f_source.html">gabs.f</a>.</p>

</div>
</div>
<a class="anchor" id="ga456c2747eddc4e9792e9c052fc3dfb2a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine getgridbounds </td>
          <td>(</td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to collect up the GRID boundaries for use in creating NADCON 5. </p>
<p>This CAN BE different than the MAP boundaries as such:</p>
<p>GRID boundaries will be just four values (n/s/w/e) for any region</p>
<p>MAP boundaries will allow multiple maps to be made and may or may not align with the GRID boundaries. Used to allow for more "close up" maps and such, without the need to screw up the MAP boundaries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">region</td><td>Region Name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xn</td><td>north boundary for this region </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xs</td><td>south boundary for this region </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xw</td><td>west boundary for this region </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xe</td><td>east boundary for this region</td></tr>
  </table>
  </dd>
</dl>
<h3>Subroutine Input Files:</h3>
<ul>
<li>`Data/grid.parameters </li>
</ul>

<p>Definition at line <a class="el" href="getgridbounds_8f_source.html#l00030">30</a> of file <a class="el" href="getgridbounds_8f_source.html">getgridbounds.f</a>.</p>

<p>Referenced by <a class="el" href="checkgrid_8f_source.html#l00100">checkgrid()</a>, <a class="el" href="makework_8f_source.html#l00150">makework()</a>, <a class="el" href="mymedian5_8f_source.html#l00071">mymedian5()</a>, and <a class="el" href="myrms_8f_source.html#l00101">myrms()</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">c - Subroutine to collect up the GRID boundaries</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">c - for use in creating NADCON 5</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">c - This CAN BE different than the MAP boundaries</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">c - as such:</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">c -  GRID boundaries will be just four values (n/s/w/e) for any region</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">c -  MAP boundaries will allow multiple maps to be made and may or may</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">c -  not align with the GRID boundaries.  Used to allow for more </span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">c -  &quot;close up&quot; maps and such, without the need to screw up the</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">c -  MAP boundaries.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">c - Input:</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">c     region</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c - Output:</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">c     xn,xs,xw,xe = N/S/W/E boundaries of the grid to be </span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c                   created for this region</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordtype">character*10</span> region</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordtype">real*8</span>    xn,xs,xw,xe</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">character*80</span> card</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      ifile = 3</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keyword">open</span>(ifile,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;     *file=<span class="stringliteral">&#39;Data/grid.parameters&#39;</span>,</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;     *status=<span class="stringliteral">&#39;old&#39;</span>,form=<span class="stringliteral">&#39;formatted&#39;</span>)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">c - Read 2 header lines</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">read</span>(ifile,<span class="stringliteral">&#39;(a)&#39;</span>)card</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">read</span>(ifile,<span class="stringliteral">&#39;(a)&#39;</span>)card</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">c - Now loop and find our region</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    1 <span class="keyword">read</span>(ifile,<span class="stringliteral">&#39;(a)&#39;</span>,end=2)card </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">if</span>(trim(card(1:10)).eq.trim(region))<span class="keywordflow">then</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          <span class="keyword">read</span>(card(14:23),*)xn</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          <span class="keyword">read</span>(card(27:36),*)xs</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          <span class="keyword">read</span>(card(40:49),*)xw</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          <span class="keyword">read</span>(card(53:62),*)xe</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          <span class="keyword">close</span>(ifile)</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          <span class="keywordflow">return</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">goto</span> 1</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">c - If we get here, the region sent to this subroutine wasn&#39;t found</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">c - in our file /Data/grid.parameters.  Crash and burn.</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    2 <span class="keyword">write</span>(6,100)trim(region)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      stop 10001 </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  100 <span class="keyword">format</span>(6x,<span class="stringliteral">&#39;FATAL Subroutine getgridbounds: Unknown region: &#39;</span>,a)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div></div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga456c2747eddc4e9792e9c052fc3dfb2a_icgraph.svg" width="251" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga7abb43855645428af96aacf2447e7caf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine getmag </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to return the magnitude of a double precision value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>result, magnitude of ix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ix</td><td>input douple precision </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="getmag_8f_source.html#l00013">13</a> of file <a class="el" href="getmag_8f_source.html">getmag.f</a>.</p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">c - Subroutine to return the magnitude of a double precision</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">c - value.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      <span class="keywordtype">implicit real*8</span> (a-h,o-z)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      y = dlog10(x)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      ix = floor(y) </div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; getmag: x,y,ix = &#39;</span>,x,y,ix</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      <span class="keywordflow">return</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga34660db69356d6ab42d986fc2f85d158"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine getmapbounds </td>
          <td>(</td>
          <td class="paramtype">character*1&#160;</td>
          <td class="paramname"><em>mapflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxplots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nplots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>olddtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>newdtm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>be</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>bn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>jm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>b2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*10, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>lrv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>rv0x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>rv0y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(maxplots)&#160;</td>
          <td class="paramname"><em>rl0y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to collect up the MAP boundaries for use in creating NADCON 5. </p>
<p>This CAN BE different than the GRID boundaries as such:</p>
<p>GRID boundaries will be just four values (n/s/w/e) for any region</p>
<p>MAP boundaries will allow multiple maps to be made and may or may not align with the GRID boundaries. Used to allow for more "close up" maps and such, without the need to screw up the MAP boundaries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mapflag</td><td>Map Generation Flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxplots</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">region</td><td>region to get map bounds </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nplots</td><td>number of plots generated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">olddtm</td><td>source datum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newdtm</td><td>target datum </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bw</td><td>western bound of plot (Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">be</td><td>eastern bound of plot (Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bs</td><td>southern bound of plot (Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bn</td><td>northern bound of plot (Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jm</td><td>(Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">b1</td><td>(Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">b2</td><td>(Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fn</td><td>(Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lrv</td><td>(Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rv0x</td><td>(Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rv0y</td><td>(Array of length <code>maxplots</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rl0y</td><td>(Array of length <code>maxplots</code>)</td></tr>
  </table>
  </dd>
</dl>
<p>Version for NADCON 5 Built upon the original version used in GEOCON v2.0 Do not use with GEOCON v2.0</p>
<p>Broken down into sub-subroutines to make it easier to swap out when I make different choices.</p>
<h2>Changelog</h2>
<h3>2016 08 29:</h3>
<p>Taking in olddtm and newdtm now, and adding code to use that to filter out "Saint" regions in Alaska when plotting transformations not supported in those regions.</p>
<h3>2016 08 26:</h3>
<p>Used actual mercator projection math to compute the exact reference vector and label locations 1/2 inch and 3/4 inch respectively below the S/W corner of the plot.</p>
<h3>2016 07 21:</h3>
<p>Two new columns added to "map.parameters", which have the location of the reference vector. Return a logical "lrv" as true if there is an optional special location for the reverence vector. Return as false if not. If true, return lon/lat coords of ref vector origin in rv0x/rv0y. If false, return zeros in those fields.</p>
<p>Also, compute "jm" on the fly, ignoring what is in the table. All plots will now be forced PORTRAIT and forced no wider than 6" and no taller
 than 8", while maintaining proper X/Y ratios in a Mercator projection. That means, make the biggest plot possible, with the right ratio, that is neither wider than 6" nor taller than 8" and then, whatever the width of that largest plot is &ndash; return that width in the "jm" field. </p>

<p>Definition at line <a class="el" href="getmapbounds_8f_source.html#l00077">77</a> of file <a class="el" href="getmapbounds_8f_source.html">getmapbounds.f</a>.</p>

<p>Referenced by <a class="el" href="checkgrid_8f_source.html#l00100">checkgrid()</a>, <a class="el" href="makeplotfiles01_8f_source.html#l00058">makeplotfiles01()</a>, <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>, and <a class="el" href="makeplotfiles03_8f_source.html#l00088">makeplotfiles03()</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">c - 2016 08 29:  Taking in olddtm and newdtm now, and adding</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">c - code to use that to filter out &quot;Saint&quot; regions in Alaska</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">c - when plotting transformations not supported in those regions.</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">c - 2016 08 26:  Used actual mercator projection math to compute </span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">c - the exact reference vector and label locations 1/2 inch and</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">c - 3/4 inch respectively below the S/W corner of the plot.</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">c - Updated 2016 07 21:  Two new columns added to &quot;map.parameters&quot;, which </span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">c - have the location of the reference vector.  Return a logical &quot;lrv&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">c - as true if there is an optional special location for the reverence vector.</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">c - Return as false if not.  If true, return lon/lat coords of ref vector</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">c - origin in rv0x/rv0y.  If false, return zeros in those fields.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">c - </span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">c - Also, compute &quot;jm&quot; on the fly, ignoring what is in the table.  All plots</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">c - will now be forced PORTRAIT and forced no wider than 6&quot; and no taller</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">c - than 8&quot;, while maintaining proper X/Y ratios in a Mercator projection.</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">c - That means, make the biggest plot possible, with the right ratio, that</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">c - is neither wider than 6&quot; nor taller than 8&quot; and then, whatever the width</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">c - of that largest plot is -- return that width in the &quot;jm&quot; field.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">c - Subroutine to collect up the MAP boundaries</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">c - for use in creating NADCON 5</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">c - This CAN BE different than the GRID boundaries</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">c - as such:</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">c -  GRID boundaries will be just four values (n/s/w/e) for any region</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">c</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">c -  MAP boundaries will allow multiple maps to be made and may or may</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">c -  not align with the GRID boundaries.  Used to allow for more </span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">c -  &quot;close up&quot; maps and such, without the need to screw up the</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">c -  MAP boundaries.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">c - Input:</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">c     region, maxplots, mapflag</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">c     olddtm, newdtm</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">c - Output:</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">c     number of plots, their bounds, their GMT scales and</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">c     label deltas</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">c - Version for NADCON 5</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">c - Built upon the original version used in GEOCON v2.0</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">c - Do not use with GEOCON v2.0</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">c - Broken down into sub-subroutines to make it easier</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">c - to swap out when I make different choices.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordtype">character*10</span> region,olddtm,newdtm</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordtype">real*8</span>    bw(maxplots),be(maxplots),bs(maxplots),bn(maxplots)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordtype">real*4</span>    jm(maxplots)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordtype">real*4</span> b1(maxplots),b2(maxplots)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordtype">character*10</span> fn(maxplots)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keywordtype">character*1</span> mapflag</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">c - 2016 07 21:</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordtype">logical</span> lrv(maxplots)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordtype">real*8</span> rv0x(maxplots),rv0y(maxplots),rl0y(maxplots)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordtype">character*3</span> c3x,c3y</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordtype">character*2</span> c2x,c2y</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordtype">real*8</span> pi,d2r</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordtype">character*200</span> card</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      pi = 2.d0*dasin(1.d0)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      d2r = pi/180.d0</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      ifile = 3</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">open</span>(ifile,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;     *file=<span class="stringliteral">&#39;Data/map.parameters&#39;</span>,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;     *status=<span class="stringliteral">&#39;old&#39;</span>,form=<span class="stringliteral">&#39;formatted&#39;</span>)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">c - Get numerical version of mapflag</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keyword">read</span>(mapflag,*)iflag</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">c - Get the header out of the way</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keyword">read</span>(ifile,<span class="stringliteral">&#39;(a)&#39;</span>)card</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keyword">read</span>(ifile,<span class="stringliteral">&#39;(a)&#39;</span>)card</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">c - Loop over all map parameters, finding the ones relevant to </span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">c - our region and mapflag.</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      i  = 0</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    1 <span class="keyword">read</span>(ifile,<span class="stringliteral">&#39;(a)&#39;</span>,end=2)card</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span>(card( 1:10).ne.region)<span class="keywordflow">goto</span> 1</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keyword">read</span>(card(14:14),*)iflag0</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span>(iflag0.gt.iflag)<span class="keywordflow">goto</span> 1</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">c - 2016 08 29:</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">c - Specific to the case where we are looking at region=alaska,</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">c - and NOT region=&lt;some saint island&gt;, then for the specific</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">c - case of transforming from NAD 27 forward, let&#39;s skip</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">c - the &lt;saint islands&gt;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span>(region.eq.<span class="stringliteral">&#39;alaska&#39;</span> .and.</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     *     iflag.eq.2 .and.</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;     *     iflag0.eq.2 .and.</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;     *     (card(16:25).eq.<span class="stringliteral">&#39;stpaul&#39;</span> .or.</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;     *      card(16:25).eq.<span class="stringliteral">&#39;stgeorge&#39;</span> .or.</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;     *      card(16:25).eq.<span class="stringliteral">&#39;stlawrence&#39;</span> .or.</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;     *      card(16:25).eq.<span class="stringliteral">&#39;stmatthew&#39;</span>) .and.</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     *      olddtm.eq.<span class="stringliteral">&#39;nad27&#39;</span> )<span class="keywordflow">goto</span> 1</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        i = i + 1</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        fn(i) = trim(card( 16: 25))</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keyword">read</span>(card( 27: 30),*)iwd</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keyword">read</span>(card( 32: 33),*)iwm</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">read</span>(card( 35: 38),*)ied</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keyword">read</span>(card( 40: 41),*)iem</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keyword">read</span>(card( 43: 45),*)isd</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keyword">read</span>(card( 47: 48),*)ism</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keyword">read</span>(card( 50: 52),*)ind</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keyword">read</span>(card( 54: 55),*)inm</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keyword">read</span>(card( 57: 60),*)xjm</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keyword">read</span>(card( 62: 64),*)ib1d</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keyword">read</span>(card( 66: 67),*)ib1m</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">read</span>(card( 69: 71),*)ib2d</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keyword">read</span>(card( 73: 74),*)ib2m</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">c - 2016 07 21:</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keyword">read</span>(card( 76: 78),<span class="stringliteral">&#39;(a3)&#39;</span>)c3x</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keyword">read</span>(card( 80: 81),<span class="stringliteral">&#39;(a2)&#39;</span>)c2x</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keyword">read</span>(card( 83: 85),<span class="stringliteral">&#39;(a3)&#39;</span>)c3y</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">read</span>(card( 87: 88),<span class="stringliteral">&#39;(a2)&#39;</span>)c2y</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        bw(i) = dble(iwd) + dble(iwm)/60.d0</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        be(i) = dble(ied) + dble(iem)/60.d0</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span>(ind.lt.0)inm = -inm</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span>(isd.lt.0)ism = -ism</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        bn(i) = dble(ind) + dble(inm)/60.d0</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        bs(i) = dble(isd) + dble(ism)/60.d0</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        jm(i) = xjm</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        b1(i) = dble(ib1d) + dble(ib1m)/60.d0</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        b2(i) = dble(ib2d) + dble(ib2m)/60.d0</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">c - 2016 07 21 (Optional reference vector locations):</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span>(c3x.eq.<span class="stringliteral">&#39;---&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          lrv(i) = .false.</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          rv0x(i) = 0</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          rv0y(i) = 0</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          lrv(i) = .true.</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="keyword">read</span>(c3x,*)rv0xd</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="keyword">read</span>(c2x,*)rv0xm</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <span class="keyword">read</span>(c3y,*)rv0yd</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          <span class="keyword">read</span>(c2y,*)rv0ym</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          rv0x(i) = dble(rv0xd) + dble(rv0xm)/60.d0</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          rv0y(i) = dble(rv0yd) + dble(rv0ym)/60.d0</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">c - 2016 07 21 (Forcing the map to keep its proper Mercator-projected X/Y ratio,</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">c - while filling the maximum space that does not exceed 6&quot; wide nor 8&quot; high)</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        dx = (be(i) - bw(i)) * d2r </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        q1 = dtan(bn(i)*d2r)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        q2 = 1.d0 / dcos(bn(i)*d2r)          <span class="comment">! Secant</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        yn = log(q1 + q2)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        q1 = dtan(bs(i)*d2r)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        q2 = 1.d0 / dcos(bs(i)*d2r)          <span class="comment">! Secant</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        ys = log(q1 + q2)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        dy = yn - ys</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        ratio = dx/dy</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">c - Max height and width</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">c       xmxht = 8</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        xmxht = 6</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        xmxwd = 6</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span>(xmxht*ratio .gt. xmxwd)<span class="keywordflow">then</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          jm(i) = xmxwd</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">c - And height = xmxwd / ratio...          </span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          jm(i) = xmxht*ratio</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">c - And height = xmxht</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">c - 2016 08 26</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">c       See DRU-12, p. 56-57</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">c - dy/dphi is linear for latitudes south of 65. All of our plots</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">c - have at most a 65 degree south border.  So I can use that for</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">c - a pretty good approximation to compute the latitude of the</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">c - reference vector, in degrees, to send back as &quot;rv0y&quot;.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">c   First, get the ratio of dx/dy in the lower left part of the</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">c - plot.  Use 1% of the E/W span and apply that both ways.</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        ddum = 0.01d0*(be(i) - bw(i))</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        ydum = bs(i) + ddum</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        xdum = bw(i) + ddum</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        xw = bw(i) * d2r</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        xe = xdum  * d2r</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        dx = (xe - xw)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        q1 = dtan(ydum*d2r)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        q2 = 1.d0 / dcos(ydum*d2r)          <span class="comment">! Secant</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        yn = log(q1 + q2)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        q1 = dtan(bs(i)*d2r)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        q2 = 1.d0 / dcos(bs(i)*d2r)          <span class="comment">! Secant</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        ys = log(q1 + q2)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">c - dy is in radians</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        dy = yn - ys</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">c - Now I have a new &quot;dx&quot; and &quot;dy&quot; representing the lower left 1% of the plot,</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">c - in radians/radians.  Compute the new ratio for this part.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        ratio = dx/dy</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">c - Since radians to inches does NOT change in the E/W direction, and since </span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">c - I know exactly how wide the plot is, I can compute a radians/inch conversion</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">c - in E/W, for 1% of the width of the plot.  </span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        r2iew = (0.01d0 * jm(i)) / dx</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">c - The ratio of dx/dy, is going to be identical to the ratio of r2iew/r2ins:</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        r2ins = r2iew / ratio</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">c - Convert r2ins into degrees-to-inches</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        d2ins = r2ins * d2r</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">c - Now, the south edge is known in degrees.  I want the reference vector</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">c - to be 1/2 inch below that.  I want the reference vector label to </span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">c - be an additional 1/4 inches down.</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        rv0y(i) = bs(i) - (0.50d0)/d2ins</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        rl0y(i) = bs(i) - (0.65d0)/d2ins</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">c - And set the reference vector&#39;s left edge to equal the left edge of the plot</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        rv0x(i) = bw(i)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">c - Flags for debugging</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keyword">write</span>(6,8) trim(fn(i))</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   8    <span class="keyword">format</span>(<span class="stringliteral">&#39;***************************&#39;</span>,/,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;     *  <span class="stringliteral">&#39;Reference Vector Computations for&#39;</span>,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;     *  <span class="stringliteral">&#39;Sub-Region: &#39;</span>,a)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; yn,ys,dy         = &#39;</span>,yn,ys,dy</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; xe,xw,dx         = &#39;</span>,xe,xw,dx</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; E/W width (jm)   = &#39;</span>,jm(i)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; SW ratio         = &#39;</span>,ratio</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; SW bounds,Lat    = &#39;</span>,ydum,bs(i)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; SW bounds,Lon    = &#39;</span>,xdum,bw(i)</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; r2i E/W          = &#39;</span>,r2iew</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; r2i N/S          = &#39;</span>,r2ins</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; d2i N/S          = &#39;</span>,d2ins</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; Southwest corner = &#39;</span>,bs(i),bw(i)</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; Ref Vector       = &#39;</span>,rv0y(i),rv0x(i)</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; Ref Label        = &#39;</span>,rl0y(i),rv0x(i)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">goto</span> 1</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    2 nplots = i</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keyword">close</span>(ifile)</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">if</span>(nplots.eq.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keyword">write</span>(6,100)trim(region)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        stop 10001 </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  100 <span class="keyword">format</span>(6x,<span class="stringliteral">&#39;FATAL Subroutine getmapbounds: Unknown region: &#39;</span>,a)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">return</span></div></div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga34660db69356d6ab42d986fc2f85d158_icgraph.svg" width="279" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1593f511d0df7cf215e5eb55d297e515"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gridstats </td>
          <td>(</td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>med</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to print grid statistics to stdout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fname</td><td>name of grid stat file </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ave</td><td>average </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">std</td><td>standard deviatio </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">median</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gridstats_8f_source.html#l00014">14</a> of file <a class="el" href="gridstats_8f_source.html">gridstats.f</a>.</p>

<p>Referenced by <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>, and <a class="el" href="makeplotfiles03_8f_source.html#l00088">makeplotfiles03()</a>.</p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      <span class="keywordtype">implicit real*8</span>(a-h,o-z)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      parameter(nmax = 1561*3541)</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      <span class="keywordtype">real*8</span> med</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      <span class="keywordtype">real*4</span> data(5000),s1,<a class="code" href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a>,arr(nmax)</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      <span class="keywordtype">integer*4</span> nla,nlo,ikind</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      <span class="keywordtype">character*200</span> fname</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      <span class="keyword">open</span>(11,file=fname,status=<span class="stringliteral">&#39;old&#39;</span>,form=<span class="stringliteral">&#39;unformatted&#39;</span>)</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      ave = 0.d0</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      rms = 0.d0</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      <span class="keyword">read</span>(11)glamn,glomn,dla,dlo,nla,nlo,ikind</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      <span class="keywordflow">if</span>(ikind.eq.0)stop 20304</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      ikt = 0</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordflow">do</span> 1 i=1,nla</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="keywordflow">if</span>(ikind.eq.1)<span class="keyword">read</span>(11)(<span class="keyword">data</span>(j),j=1,nlo)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordflow">do</span> 3 j=1,nlo</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;          ikt = ikt + 1</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;          arr(ikt) = <span class="keyword">data</span>(j)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    3   <span class="keywordflow">continue</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keywordflow">do</span> 2 j=1,nlo</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;          ave = ave + dble(<span class="keyword">data</span>(j))</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;          rms = rms + dble(<span class="keyword">data</span>(j))**2</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    2   <span class="keywordflow">continue</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    1 <span class="keywordflow">continue</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      fact = dble(nla*nlo) / dble(nla*nlo - 1)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      ave = ave / dble(nla*nlo)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      rms = sqrt(rms / dble(nla*nlo))</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      std = dsqrt(fact*(rms**2 - ave**2))</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      npts = ikt</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      nmed = 1+ ikt/2</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; IN gridstats, npts = &#39;</span>,npts</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; IN gridstats, nmed = &#39;</span>,nmed</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">c     nmed = ikt/3</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      s1 = <a class="code" href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a>(nmed,npts,arr,nmax)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; IN gridstats, s1   = &#39;</span>,s1</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      med = s1</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keyword">write</span>(6,*) <span class="stringliteral">&#39; IN gridstats, med  = &#39;</span>,med</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keyword">write</span>(6,100)trim(fname),ave,std,med</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  100 <span class="keyword">format</span>(<span class="stringliteral">&#39;gridstats for &#39;</span>,a,<span class="stringliteral">&#39; = &#39;</span>,3f20.10)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">close</span>(11)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_gace8271d29dcfcca5a034f3c4c79fb3f5"><div class="ttname"><a href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a></div><div class="ttdeci">real *8 function select2(k, n, arr, nmax)</div><div class="ttdoc">Function to select an element of a partially filled, but packed multi dimensional array...</div><div class="ttdef"><b>Definition:</b> <a href="select2__dbl_8for_source.html#l00022">select2_dbl.for:22</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga1593f511d0df7cf215e5eb55d297e515_icgraph.svg" width="244" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae48a8903c06928f4cfdeda12711566a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program gscale </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Scales a grid by a factor. </p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>Input File Name </td></tr>
    <tr><td class="paramname">factor</td><td>Scaling Factor </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin1</code> Input File</li>
</ul>
<h3>Program Outputs:</h3>
<ul>
<li><code>lout</code> Output File </li>
</ul>

<p>Definition at line <a class="el" href="gscale_8f_source.html#l00027">27</a> of file <a class="el" href="gscale_8f_source.html">gscale.f</a>.</p>

</div>
</div>
<a class="anchor" id="gae4a498ff62bccd7dbd17c4ca5d26b5cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program gsqr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Squares values in a <code>*.b</code> grid. </p>
<p>Belongs to the suite of ".b" file manipulators</p>
<p>This program will convert every value in a ".b" grid to its squared value.</p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>Input File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin</code> Input File (<code>*.b</code> grid)</li>
</ul>
<h3>Program Outputs:</h3>
<ul>
<li><code>lout</code> Output File (<code>*.b</code> grid) </li>
</ul>

<p>Definition at line <a class="el" href="gsqr_8f_source.html#l00030">30</a> of file <a class="el" href="gsqr_8f_source.html">gsqr.f</a>.</p>

</div>
</div>
<a class="anchor" id="ga42a9950155f63d600bb7e30d779af7b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program gsqrt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Square Root of values in a <code>*.b</code> grid. </p>
<p>Belongs to the suite of ".b" file manipulators</p>
<p>This program will convert every value in a ".b" grid to its square-root value.</p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>Input File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin</code> Input File (<code>*.b</code> grid)</li>
</ul>
<h3>Program Outputs:</h3>
<ul>
<li><code>lout</code> Output File (<code>*.b</code> grid) </li>
</ul>

<p>Definition at line <a class="el" href="gsqrt_8f_source.html#l00030">30</a> of file <a class="el" href="gsqrt_8f_source.html">gsqrt.f</a>.</p>

</div>
</div>
<a class="anchor" id="gaec1b049dc4be13c46b684423fc31805e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine indexxd </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(nd)&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nd)&#160;</td>
          <td class="paramname"><em>indx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to perform ?? indexing on floating point data (double precision) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>number of iterations (rows?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nd</td><td>array and index dimensions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arr</td><td>input data array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">indx</td><td>index out</td></tr>
  </table>
  </dd>
</dl>
<h2>Changelog</h2>
<h3>1/8/2004:</h3>
<p>Modified to allow <code>indx</code> and <code>arr</code> to be DIMENSIONED differently than the number of good values they contain</p>
<h3>11/7/2003</h3>
<p>Modified to REAL*8 by D. Smith, </p>

<p>Definition at line <a class="el" href="indexxd_8for_source.html#l00024">24</a> of file <a class="el" href="indexxd_8for_source.html">indexxd.for</a>.</p>

<p>Referenced by <a class="el" href="mymedian5_8f_source.html#l01334">getmedian()</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">c - Modified to REAL*8 by D. Smith, 11/7/2003</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">c - Further modified 1/8/2004 to allow indx and arr to</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">c - be DIMENSIONED differently than the number of good</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">c - values they contain</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordtype">integer</span> nd</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">INTEGER</span> n,indx(nd),m,nstack</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordtype">REAL*8</span> arr(nd)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      parameter(m=7,nstack=50)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordtype">INTEGER</span> i,indxt,ir,itemp,j,jstack,k,l,istack(nstack)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordtype">REAL*8</span> a</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordflow">do</span> 11 j=1,n</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        indx(j)=j</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;11    <span class="keywordflow">continue</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      jstack=0</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      l=1</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      ir=n</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;1     <span class="keywordflow">if</span>(ir-l.lt.m)<span class="keywordflow">then</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">do</span> 13 j=l+1,ir</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;          indxt=indx(j)</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;          a=arr(indxt)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;          <span class="keywordflow">do</span> 12 i=j-1,1,-1</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">if</span>(arr(indx(i)).le.a)<span class="keywordflow">goto</span> 2</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            indx(i+1)=indx(i)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;12        <span class="keywordflow">continue</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          i=0</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;2         indx(i+1)=indxt</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;13      <span class="keywordflow">continue</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">if</span>(jstack.eq.0)<span class="keywordflow">return</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        ir=istack(jstack)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        l=istack(jstack-1)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        jstack=jstack-2</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        k=(l+ir)/2</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        itemp=indx(k)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        indx(k)=indx(l+1)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        indx(l+1)=itemp</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span>(arr(indx(l+1)).gt.arr(indx(ir)))<span class="keywordflow">then</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          itemp=indx(l+1)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          indx(l+1)=indx(ir)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          indx(ir)=itemp</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">if</span>(arr(indx(l)).gt.arr(indx(ir)))<span class="keywordflow">then</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          itemp=indx(l)</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          indx(l)=indx(ir)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          indx(ir)=itemp</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span>(arr(indx(l+1)).gt.arr(indx(l)))<span class="keywordflow">then</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          itemp=indx(l+1)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          indx(l+1)=indx(l)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;          indx(l)=itemp</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        i=l+1</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        j=ir</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        indxt=indx(l)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        a=arr(indxt)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;3       <span class="keywordflow">continue</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          i=i+1</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span>(arr(indx(i)).lt.a)<span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;4       <span class="keywordflow">continue</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;          j=j-1</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span>(arr(indx(j)).gt.a)<span class="keywordflow">goto</span> 4</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">if</span>(j.lt.i)<span class="keywordflow">goto</span> 5</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        itemp=indx(i)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        indx(i)=indx(j)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        indx(j)=itemp</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;5       indx(l)=indx(j)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        indx(j)=indxt</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        jstack=jstack+2</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">if</span>(jstack.gt.nstack)pause <span class="stringliteral">&#39;NSTACK too small in indexx&#39;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">if</span>(ir-i+1.ge.j-l)<span class="keywordflow">then</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          istack(jstack)=ir</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          istack(jstack-1)=i</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          ir=j-1</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          istack(jstack)=j-1</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          istack(jstack-1)=l</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          l=i</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">goto</span> 1</div></div><!-- fragment -->
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gaec1b049dc4be13c46b684423fc31805e_icgraph.svg" width="346" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaada1f7f6294a20b1828bd4d1b7e37ca0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine indexxi </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer*4, dimension(nd)&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nd)&#160;</td>
          <td class="paramname"><em>indx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to perform ?? indexing on integer data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>number of iterations (rows?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nd</td><td>array and index dimensions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arr</td><td>input data array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">indx</td><td>index out</td></tr>
  </table>
  </dd>
</dl>
<h2>Changelog</h2>
<h3>2/5/2013:</h3>
<p>Modified by D. Smith. Arr has been changed to integer*4. And like other versions of "indexx" which I've modified, I allow indx and arr to be DIMENSIONED differently than the number of good values they contain</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nd</td><td>Modified by D. Smith, 2/5/2013 . Arr has been changed to integer*4. And like other versions of "indexx" which I've modified, I allow indx and arr to be DIMENSIONED differently than the number of good values they contain </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="indexxi_8for_source.html#l00024">24</a> of file <a class="el" href="indexxi_8for_source.html">indexxi.for</a>.</p>

<p>Referenced by <a class="el" href="mymedian5_8f_source.html#l00071">mymedian5()</a>, and <a class="el" href="myrms_8f_source.html#l00101">myrms()</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">c&gt; Modified by D. Smith, 2/5/2013 .  Arr has been</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">c&gt; changed to integer*4.  And like other versions</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">c&gt; of &quot;indexx&quot; which I&#39;ve modified, </span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">c&gt; I allow indx and arr to</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">c&gt; be DIMENSIONED differently than the number of good</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">c&gt; values they contain</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordtype">integer</span> nd</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordtype">INTEGER</span> n,indx(nd),m,nstack</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">cDAS  REAL*4 arr(nd)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordtype">integer*4</span> arr(nd)</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      parameter(m=7,nstack=50)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordtype">INTEGER</span> i,indxt,ir,itemp,j,jstack,k,l,istack(nstack)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">cDAS  REAL*4 a     </span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordtype">integer*4</span> a </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">do</span> 11 j=1,n</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        indx(j)=j</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;11    <span class="keywordflow">continue</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      jstack=0</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      l=1</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      ir=n</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;1     <span class="keywordflow">if</span>(ir-l.lt.m)<span class="keywordflow">then</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">do</span> 13 j=l+1,ir</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          indxt=indx(j)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;          a=arr(indxt)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;          <span class="keywordflow">do</span> 12 i=j-1,1,-1</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="keywordflow">if</span>(arr(indx(i)).le.a)<span class="keywordflow">goto</span> 2</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            indx(i+1)=indx(i)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;12        <span class="keywordflow">continue</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          i=0</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;2         indx(i+1)=indxt</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;13      <span class="keywordflow">continue</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span>(jstack.eq.0)<span class="keywordflow">return</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        ir=istack(jstack)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        l=istack(jstack-1)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        jstack=jstack-2</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        k=(l+ir)/2</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        itemp=indx(k)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        indx(k)=indx(l+1)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        indx(l+1)=itemp</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">if</span>(arr(indx(l+1)).gt.arr(indx(ir)))<span class="keywordflow">then</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          itemp=indx(l+1)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          indx(l+1)=indx(ir)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          indx(ir)=itemp</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span>(arr(indx(l)).gt.arr(indx(ir)))<span class="keywordflow">then</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          itemp=indx(l)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;          indx(l)=indx(ir)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          indx(ir)=itemp</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">if</span>(arr(indx(l+1)).gt.arr(indx(l)))<span class="keywordflow">then</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          itemp=indx(l+1)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;          indx(l+1)=indx(l)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;          indx(l)=itemp</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        i=l+1</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        j=ir</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        indxt=indx(l)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        a=arr(indxt)</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;3       <span class="keywordflow">continue</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          i=i+1</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">if</span>(arr(indx(i)).lt.a)<span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;4       <span class="keywordflow">continue</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          j=j-1</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">if</span>(arr(indx(j)).gt.a)<span class="keywordflow">goto</span> 4</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span>(j.lt.i)<span class="keywordflow">goto</span> 5</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        itemp=indx(i)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        indx(i)=indx(j)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        indx(j)=itemp</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;5       indx(l)=indx(j)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        indx(j)=indxt</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        jstack=jstack+2</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">if</span>(jstack.gt.nstack)pause <span class="stringliteral">&#39;NSTACK too small in indexx&#39;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span>(ir-i+1.ge.j-l)<span class="keywordflow">then</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          istack(jstack)=ir</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          istack(jstack-1)=i</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          ir=j-1</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          istack(jstack)=j-1</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          istack(jstack-1)=l</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          l=i</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">goto</span> 1</div></div><!-- fragment -->
<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gaada1f7f6294a20b1828bd4d1b7e37ca0_icgraph.svg" width="211" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga65b0a0e3ed4141584f0cd6f134541efd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer*2 function iselect2 </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer*2, dimension(nmax)&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to select an element of a partially filled, but packed multi dimensional array, <code>integer*2</code> </p>
<p>Finds the "kth" element of an array, "arr", which is dimensioned to be "nmax" values long, but which only has data in the first "n" cells.</p>
<h2>Changelog</h2>
<h3>1/14/2016:</h3>
<p>Like "select2" but modified by D. Smith to allow an "nmax" array given, but which only has values in elements 1-n, and to have "arr" be Integer*2 </p>

<p>Definition at line <a class="el" href="iselect2_8for_source.html#l00022">22</a> of file <a class="el" href="iselect2_8for_source.html">iselect2.for</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">c - Like &quot;select2&quot; but modified by D. Smith on 1/14/2016</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">c - to allow an &quot;nmax&quot; array given, but which only</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">c - has values in elements 1-n, and to have &quot;arr&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">c - be Integer*2</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordtype">INTEGER</span> k,n,nmax</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">c     REAL*8 select,arr(nmax)</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">integer*2</span> <a class="code" href="group__core.html#ga65b0a0e3ed4141584f0cd6f134541efd">iselect2</a>,arr(nmax)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordtype">INTEGER</span> i,ir,j,l,mid</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">c     REAL*8 a,temp</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordtype">integer*2</span> a,temp</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      l=1</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      ir=n</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;1     <span class="keywordflow">if</span>(ir-l.le.1)<span class="keywordflow">then</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">if</span>(ir-l.eq.1)<span class="keywordflow">then</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;          <span class="keywordflow">if</span>(arr(ir).lt.arr(l))<span class="keywordflow">then</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            temp=arr(l)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            arr(l)=arr(ir)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            arr(ir)=temp</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="group__core.html#ga65b0a0e3ed4141584f0cd6f134541efd">iselect2</a>=arr(k)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        mid=(l+ir)/2</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        temp=arr(mid)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        arr(mid)=arr(l+1)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        arr(l+1)=temp</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span>(arr(l+1).gt.arr(ir))<span class="keywordflow">then</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          temp=arr(l+1)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          arr(l+1)=arr(ir)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          arr(ir)=temp</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">if</span>(arr(l).gt.arr(ir))<span class="keywordflow">then</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;          temp=arr(l)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;          arr(l)=arr(ir)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          arr(ir)=temp</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span>(arr(l+1).gt.arr(l))<span class="keywordflow">then</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          temp=arr(l+1)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          arr(l+1)=arr(l)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          arr(l)=temp</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        i=l+1</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        j=ir</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        a=arr(l)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;3       <span class="keywordflow">continue</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          i=i+1</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span>(arr(i).lt.a)<span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;4       <span class="keywordflow">continue</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          j=j-1</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span>(arr(j).gt.a)<span class="keywordflow">goto</span> 4</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span>(j.lt.i)<span class="keywordflow">goto</span> 5</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        temp=arr(i)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        arr(i)=arr(j)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        arr(j)=temp</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;5       arr(l)=arr(j)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        arr(j)=a</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span>(j.ge.k)ir=j-1</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">if</span>(j.le.k)l=i</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">goto</span> 1</div><div class="ttc" id="group__core_html_ga65b0a0e3ed4141584f0cd6f134541efd"><div class="ttname"><a href="group__core.html#ga65b0a0e3ed4141584f0cd6f134541efd">iselect2</a></div><div class="ttdeci">integer *2 function iselect2(k, n, arr, nmax)</div><div class="ttdoc">Function to select an element of a partially filled, but packed multi dimensional array...</div><div class="ttdef"><b>Definition:</b> <a href="iselect2_8for_source.html#l00022">iselect2.for:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2a869479b7b9e7520a6ae75ed6aca46d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*4 function onzd </td>
          <td>(</td>
          <td class="paramtype">real*4&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to round a digit to one significant figure (one non zero digit), single precision. </p>
<p>Function "onzd" stands for "One Non Zero Digit"</p>
<p>It takes a Real*4 number as input, and rounds that number to the closest number containing only 1 non-zero digit. The list of such numbers is infifinite, but contain these, in order: </p><pre class="fragment">0.7 , 0.8 , 0.9 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9, 10 , 20 , 30 , etc etc
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>input value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>real*4</code> rounded value of x to one non zero digit</dd></dl>
<p>Examples of input/output are: </p><pre class="fragment">   0.000019      =&gt;    0.000020
   0.007432      =&gt;    0.007000
   1.7           =&gt;    2.000000
   9.143         =&gt;    9.000000
  17.4           =&gt;   20.000000
 947.3           =&gt;  900.000000
 987.432         =&gt; 1000.000000
1014.8           =&gt; 1000.000000
1502.7           =&gt; 2000.000000</pre> 
<p>Definition at line <a class="el" href="onzd_8f_source.html#l00033">33</a> of file <a class="el" href="onzd_8f_source.html">onzd.f</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordtype">real*4</span> <a class="code" href="group__core.html#ga2a869479b7b9e7520a6ae75ed6aca46d">onzd</a>,x,y</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="keywordtype">real*8</span> q,qten</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordtype">integer*4</span> imag,iq,isign</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      </div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">c - Function &quot;onzd&quot; stands for &quot;One Non Zero Digit&quot;  </span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">c - It takes a Real*4 number as input, and rounds that </span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">c - number to the closest number containing only 1 non-zero digit.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">c - The list of such numbers is infifinite, but contain</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">c - these, in order:</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">c -    0.7 , 0.8 , 0.9 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9, 10 , 20 , 30 , etc etc</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">c - </span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c - Examples of input/output are:</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">c -       0.000019      =&gt;    0.000020</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c -       0.007432      =&gt;    0.007000</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">c -       1.7           =&gt;    2.000000</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">c -       9.143         =&gt;    9.000000</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">c -      17.4           =&gt;   20.000000</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">c -     947.3           =&gt;  900.000000</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">c -     987.432         =&gt; 1000.000000</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">c -    1014.8           =&gt; 1000.000000</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">c -    1502.7           =&gt; 2000.000000</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;         isign = +1</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;         y = x</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;         <span class="keywordflow">if</span>(x.lt.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;           isign = -1</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;           y = -x</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordflow">         endif</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">c - 1) Determine magnitude of x, in terms of integer exponent of ten</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        imag = floor(log10(y))</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">c - 1a) Get the multiplier</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        qten = (10.d0**imag)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">c - 2) Get into a range between 0.0 and 10.0</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        q = dble(y) / qten</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">c - 3) Round to the closest integer (0 through 10)</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        iq = nint(q)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">c - 4) Scale back to the original size </span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="group__core.html#ga2a869479b7b9e7520a6ae75ed6aca46d">onzd</a> = isign * dble(iq) * qten</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">c       write(6,100)x,imag,qten,q,iq,onzd</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">c 100   format(f30.15,1x,i10,1x,f30.15,1x,f30.15,1x,i10,1x,f30.15)</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    </div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_ga2a869479b7b9e7520a6ae75ed6aca46d"><div class="ttname"><a href="group__core.html#ga2a869479b7b9e7520a6ae75ed6aca46d">onzd</a></div><div class="ttdeci">real *4 function onzd(x)</div><div class="ttdoc">Function to round a digit to one significant figure (one non zero digit), single precision. </div><div class="ttdef"><b>Definition:</b> <a href="onzd_8f_source.html#l00033">onzd.f:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadc5c9acc8aedbc27aa45d5a78980e6d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*8 function onzd2 </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to round a digit to one significant figure (one non zero digit), double precision. </p>
<p>Function "onzd" stands for "One Non Zero Digit"</p>
<p>Version 2 operates just like version 1 (<a class="el" href="group__core.html#ga2a869479b7b9e7520a6ae75ed6aca46d" title="Function to round a digit to one significant figure (one non zero digit), single precision. ">onzd()</a>), only the input and output will be real*8 values, not real*4.</p>
<p>It takes a Real*8 number as input, and rounds that number to the closest number containing only 1 non-zero digit. The list of such numbers is infifinite, but contain these, in order: </p><pre class="fragment">0.7 , 0.8 , 0.9 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9, 10 , 20 , 30 , etc etc
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>input value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>real*8</code> rounded value of x to one non zero digit</dd></dl>
<p>Examples of input/output are: </p><pre class="fragment">   0.000019      =&gt;    0.000020
   0.007432      =&gt;    0.007000
   1.7           =&gt;    2.000000
   9.143         =&gt;    9.000000
  17.4           =&gt;   20.000000
 947.3           =&gt;  900.000000
 987.432         =&gt; 1000.000000
1014.8           =&gt; 1000.000000
1502.7           =&gt; 2000.000000</pre> 
<p>Definition at line <a class="el" href="onzd2_8f_source.html#l00036">36</a> of file <a class="el" href="onzd2_8f_source.html">onzd2.f</a>.</p>

<p>Referenced by <a class="el" href="checkgrid_8f_source.html#l00100">checkgrid()</a>, <a class="el" href="makeplotfiles01_8f_source.html#l00058">makeplotfiles01()</a>, <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>, <a class="el" href="makeplotfiles03_8f_source.html#l00088">makeplotfiles03()</a>, and <a class="el" href="myrms_8f_source.html#l00101">myrms()</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keywordtype">implicit none</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordtype">real*8</span> <a class="code" href="group__core.html#gadc5c9acc8aedbc27aa45d5a78980e6d0">onzd2</a>,x,y</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordtype">real*8</span> q,qten</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordtype">integer*4</span> imag,iq,isign</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      </div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">c - Function &quot;onzd2&quot; stands for &quot;One Non Zero Digit, version 2&quot;  </span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">c - Version 2 operates just like version 1 (onzd.f), only the input</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">c - and output will be real*8 values, not real*4.</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c - It takes a Real*8 number as input, and rounds that </span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">c - number to the closest number containing only 1 non-zero digit.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c - The list of such numbers is infifinite, but contain</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">c - these, in order:</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">c -    0.7 , 0.8 , 0.9 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9, 10 , 20 , 30 , etc etc</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">c - </span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">c - Examples of input/output are:</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">c -       0.000019      =&gt;    0.000020</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">c -       0.007432      =&gt;    0.007000</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">c -       1.7           =&gt;    2.000000</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">c -       9.143         =&gt;    9.000000</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">c -      17.4           =&gt;   20.000000</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">c -     947.3           =&gt;  900.000000</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">c -     987.432         =&gt; 1000.000000</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">c -    1014.8           =&gt; 1000.000000</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">c -    1502.7           =&gt; 2000.000000</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        y = x</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        isign = +1</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span>(x.lt.0)<span class="keywordflow">then</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          isign = -1</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          y = -x</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">c - 1) Determine magnitude of x, in terms of integer exponent of ten</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        imag = floor(dlog10(y))</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">c - 1a) Get the multiplier</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        qten = (10.d0**imag)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">c - 2) Get into a range between 0.0 and 10.0</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        q = dble(y) / qten</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">c - 3) Round to the closest integer (0 through 10)</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        iq = nint(q)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">c - 4) Scale back to the original size </span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="group__core.html#gadc5c9acc8aedbc27aa45d5a78980e6d0">onzd2</a> = isign * dble(iq) * qten</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">c       write(6,100)x,imag,qten,q,iq,onzd2</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">c 100   format(f30.15,1x,i10,1x,f30.15,1x,f30.15,1x,i10,1x,f30.15)</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_gadc5c9acc8aedbc27aa45d5a78980e6d0"><div class="ttname"><a href="group__core.html#gadc5c9acc8aedbc27aa45d5a78980e6d0">onzd2</a></div><div class="ttdeci">real *8 function onzd2(x)</div><div class="ttdoc">Function to round a digit to one significant figure (one non zero digit), double precision. </div><div class="ttdef"><b>Definition:</b> <a href="onzd2_8f_source.html#l00036">onzd2.f:36</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gadc5c9acc8aedbc27aa45d5a78980e6d0_icgraph.svg" width="230" height="240"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga43be1e80c0bde6748f414d2eee05603f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine plotcoast </td>
          <td>(</td>
          <td class="paramtype">character*10&#160;</td>
          <td class="paramname"><em>region</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ifnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to write GMT-based commands to create a shoreline Write GMT-based commands to create a shoreline based on region. </p>
<p>Use GMT-default coastline for:</p><ul>
<li><code>conus</code></li>
<li><code>alaska</code></li>
</ul>
<p>Use Dru's custome coastline for:</p><ul>
<li>hawaii</li>
<li>prvi</li>
<li>as</li>
<li>guamcnmi</li>
<li>stlawrence</li>
<li>stmatthew</li>
<li>stgeorge</li>
<li>stpaul</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">region</td><td>The Region to create coastline for </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ifnum</td><td>the file descriptor of the output file to write <code>GMT</code> commands to</td></tr>
  </table>
  </dd>
</dl>
<h2>Changelog</h2>
<h3>2016 01 07:</h3>
<p>Forced the Alaska region to plot the islands of St. George, St. Matthew and St. Paul (St. Lawrence is already plotted), as well as 35 missing Aleutian Islands</p>
<h3>2015 09 23:</h3>
<p>Added four new regions:</p><ul>
<li>St. Lawrence Island, Alaska</li>
<li>St. Matthew Island, Alaska</li>
<li>St. George Island, Alaska</li>
<li>St. Paul Island, Alaska </li>
</ul>

<p>Definition at line <a class="el" href="plotcoast_8f_source.html#l00044">44</a> of file <a class="el" href="plotcoast_8f_source.html">plotcoast.f</a>.</p>

<p>Referenced by <a class="el" href="bwplotcv_8f_source.html#l00030">bwplotcv()</a>, <a class="el" href="bwplotvc_8f_source.html#l00037">bwplotvc()</a>, <a class="el" href="coplot_8f_source.html#l00074">coplot()</a>, and <a class="el" href="coplotwcv_8f_source.html#l00072">coplotwcv()</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">c - 2016 01 07</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">c     Forced the Alaska region to plot the</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">c     islands of St. George, St. Matthew and St. Paul</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">c     (St. Lawrence is already plotted), as well</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">c     as 35 missing Aleutian Islands</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">c - 2015 09 23:  Added four new regions:</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">c      St. Lawrence Island, Alaska</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">c      St. Matthew Island, Alaska</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">c      St. George Island, Alaska</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">c      St. Paul Island, Alaska</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordtype">character*10</span> region</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">c - Write GMT-based commands to create a shoreline</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">c - based on region.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">c - Use GMT-default coastline for:</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">c      conus</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">c      alaska</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">c - Use Dru&#39;s custome coastline for:</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">c      hawaii</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">c      prvi</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">c      as</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">c      guamcnmi</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">c      stlawrence</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">c      stmatthew </span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">c      stgeorge  </span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">c      stpaul    </span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span>    (trim(region).eq.<span class="stringliteral">&#39;conus&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">write</span>(ifnum,100) </div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;alaska&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keyword">write</span>(ifnum,109) </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;hawaii&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keyword">write</span>(ifnum,101) </div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;prvi&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keyword">write</span>(ifnum,102) </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;guamcnmi&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">write</span>(ifnum,103) </div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;as&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keyword">write</span>(ifnum,104) </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;stlawrence&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">write</span>(ifnum,105) </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;stmatthew&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">write</span>(ifnum,106) </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;stgeorge&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keyword">write</span>(ifnum,107) </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">elseif</span>(trim(region).eq.<span class="stringliteral">&#39;stpaul&#39;</span>)<span class="keywordflow">then</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keyword">write</span>(ifnum,108) </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;     </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keyword">write</span>(6,200)region</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        stop 10001</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">return</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  200 <span class="keyword">format</span>(<span class="stringliteral">&#39;FATAL in plotcoast.f: Unknown region: &#39;</span>,a10)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">c - CONUS </span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  100 <span class="keyword">format</span>(</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;     *<span class="stringliteral">&#39;pscoast -Df -R -JM -W0.25p -N1 -N2 -A1200 -O &gt;&gt;  plot.ps&#39;</span>)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">c - HAWAII</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  101 <span class="keyword">format</span>(</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/HI_Hawaii.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/HI_Kahoolawe.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/HI_Kauai.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/HI_Lanai.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/HI_Maui.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/HI_Molokai.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/HI_Nihau.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/HI_Oahu.gmt -R -JM -B -O &#39;</span>,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">c - PRVI</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  102 <span class="keyword">format</span>(</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/VQ_StCroix.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/VQ_StJohn.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/VQ_StThomas.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/PR_Culebra.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/PR_Desecheo.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/PR_Mona.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/PR_Viequez.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/PR_PuertoRico.gmt -R -JM -B -O &#39;</span>,</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">c - GUAM/CNMI</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  103 <span class="keyword">format</span>(</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/GQ_Guam.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Rota.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Saipan.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Tinian.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Anatahan.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Sarigan.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Guguan.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Alamagan.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Pagan.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Agrihan.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Asuncion.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_MaugWest.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_MaugEast.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_MaugNorth.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/CQ_Pajaros.gmt -R -JM -B -O&#39;</span>,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">c - AS  </span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  104 <span class="keyword">format</span>(</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AS_Aunuu.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AS_Nuutele.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AS_Ofu.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AS_Olosega.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AS_Rose.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AS_Swains.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AS_Tau.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AS_Tutila.gmt -R -JM -B -O &#39;</span>,</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">c - St. Lawrence Island, Alaska</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  105 <span class="keyword">format</span>(</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_StLawrence.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_NorthPunuk.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_MiddlePunuk.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_SouthPunuk.gmt -R -JM -B -O &#39;</span>,</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">c - St. Matthew Island, Alaska</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  106 <span class="keyword">format</span>(</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_StMatthew.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Hall.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Pinnacle.gmt -R -JM -B -O &#39;</span>,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">c - St. George Island, Alaska</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  107 <span class="keyword">format</span>(</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_StGeorge.gmt -R -JM -B -O&#39;</span>,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">c - St. Paul Island, Alaska</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  108 <span class="keyword">format</span>(</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_StPaul.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Otter.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Walrus.gmt -R -JM -B -O &#39;</span>,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">c - ALASKA</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  109 <span class="keyword">format</span>(</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;     *<span class="stringliteral">&#39;pscoast -Df -R -JM -W0.25p -N1 -N2 -A1200 -O -K &#39;</span>,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt;  plot.ps&#39;</span>,/,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_NorthPunuk.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_MiddlePunuk.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_SouthPunuk.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_StMatthew.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Hall.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Pinnacle.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_StGeorge.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_StPaul.gmt -R -JM -B -O -K&#39;</span>,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Otter.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Walrus.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Adak.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Agattu.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Amchitka.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Amlia.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Amukta.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Andreanof.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Atka.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Attu.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Buldir.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Carlisle.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Chagulak.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Chugul.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Fenimore.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_FourMountains.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_GreatSitkin.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Herbert.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Igitkin.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Ikiginak.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Kagalaska.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Kagami.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Kanaga.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Kasatochi.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Kiska.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Koniuji.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Oglodak.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Seguam.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Semichi.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Semisopochnoi.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Shemya.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Tagalak.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Tanaga.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Ulak.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Uliaga.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Umak.gmt -R -JM -B -O -K &#39;</span>,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>,/,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;     *<span class="stringliteral">&#39;psxy Boundaries/AK_Yunaska.gmt -R -JM -B -O &#39;</span>,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;     *<span class="stringliteral">&#39; &gt;&gt; plot.ps&#39;</span>)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div></div><!-- fragment -->
<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga43be1e80c0bde6748f414d2eee05603f_icgraph.svg" width="376" height="240"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaa651c892588f1308f29a4b8b02ccd183"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function qterp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function fits a quadratic function through 3 points. </p>
<p>This function fits a parabola (quadratic) function through three <em>equally</em> spaced points along the x-axis at indices 0, 1, and 2. The spacing along the x-axis is "dx"</p>
<p>Thus:</p>
<p class="formulaDsp">
\begin{eqnarray*} f0 = f_0 &amp;= y(x_0) \\ f1 = f_1 &amp;= y(x_1) \\ f2 = f_2 &amp;= y(x_2) \end{eqnarray*}
</p>
<p>Where:</p>
<p class="formulaDsp">
\begin{eqnarray*} x_1 &amp;= x_0 + dx \\ x_2 &amp;= x_1 + dx \\ x_3 &amp;= x_2 + dx \end{eqnarray*}
</p>
<p>The input value is some value of "x" that falls between 0 and 2. The output value (qterp) is the quadratic function at x.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Compute Interpolation at this positon, a value between 0 and 3 it is scaled relative to <code>x_0</code> <code>x_2</code> and <code>dx</code>. For example, the value of 1.5 is <code>x_0 + 1.5*dx</code> which falls between <code>x1</code> and <code>x2</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f0</td><td><code>y</code> value at <code>x_0</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f1</td><td><code>y</code> value at <code>x_1 = x_0 + dx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f2</td><td><code>y</code> value at <code>x_2 = x_0 + dx</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>real</code> quadratically interpolated value of <code>f(x*)</code> where <code>x* = x_0 + x*dxx</code></dd></dl>
<p>This function uses Newton-Gregory forward polynomial</p>
<p class="formulaDsp">
\begin{eqnarray*} \nabla f_0 &amp;=&amp; f_1 -f_0 \\ \nabla f_1 &amp;=&amp; f_2 -f_1 \\ \nabla^2 f_0 &amp;=&amp; \nabla f_1 - \nabla f_0 \\ qterp(x, f_0, f_1, f_2) &amp;=&amp; f_0 + x \nabla f_0 + 0.5 x \left( x-1.0 \right) \nabla^2 f_0 \end{eqnarray*}
</p>
 
<p>Definition at line <a class="el" href="qterp_8f_source.html#l00051">51</a> of file <a class="el" href="qterp_8f_source.html">qterp.f</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">c - x = real*4</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">c - f0,f1,f2 = real*4</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">c - This function fits a parabola (quadratic) through</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">c - three points, *equally* spaced along the x-axis</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">c - at indices 0, 1 and 2.  The spacing along the</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">c - x-axis is &quot;dx&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">c - Thus:</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">c - </span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">c -    f0 = y(x(0))</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">c -    f1 = y(x(1))</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">c -    f2 = y(x(2))</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">c -       Where</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">c -       x(1) = x(0) + dx</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">c -       x(2) = x(1) + dx</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">c - The input value is some value of &quot;x&quot; that falls</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">c - between 0 and 2.  The output value (qterp2) is</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">c - the parabolic function at x.</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">c - </span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">c - This function uses Newton-Gregory forward polynomial</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      df0 =f1 -f0</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      df1 =f2 -f1</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      d2f0=df1-df0</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a>=f0 + x*df0 + 0.5*x*(x-1.0)*d2f0</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">return</span></div><div class="ttc" id="group__core_html_gaa651c892588f1308f29a4b8b02ccd183"><div class="ttname"><a href="group__core.html#gaa651c892588f1308f29a4b8b02ccd183">qterp</a></div><div class="ttdeci">real function qterp(x, f0, f1, f2)</div><div class="ttdoc">This function fits a quadratic function through 3 points. </div><div class="ttdef"><b>Definition:</b> <a href="qterp_8f_source.html#l00051">qterp.f:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga82ccd3d068498097f669337f1917fa99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program regrd2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , regrid data. </p>
<p>Regrid gridded data using biquadratic interpolation</p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>Input Master Grid File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output Regrid File Name </td></tr>
    <tr><td class="paramname">nrow</td><td>Number of rows in new Grid (Lat) </td></tr>
    <tr><td class="paramname">ncol</td><td>Number of cols in new Grid (Lon)</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin</code> Input File</li>
</ul>
<h3>Program Outputs:</h3>
<ul>
<li><code>lout</code> Output File </li>
</ul>

<p>Definition at line <a class="el" href="regrd2_8f_source.html#l00029">29</a> of file <a class="el" href="regrd2_8f_source.html">regrd2.f</a>.</p>

<p>References <a class="el" href="regrd2_8f_source.html#l00173">bquad1()</a>, <a class="el" href="regrd2_8f_source.html#l00246">bquad2()</a>, <a class="el" href="regrd2_8f_source.html#l00350">r1()</a>, and <a class="el" href="regrd2_8f_source.html#l00362">r2()</a>.</p>

<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga82ccd3d068498097f669337f1917fa99_cgraph.svg" width="182" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gace8271d29dcfcca5a034f3c4c79fb3f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*8 function select2 </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8, dimension(nmax)&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to select an element of a partially filled, but packed multi dimensional array, double precision. </p>
<p>Finds the "kth" element of an array, "arr", which is dimensioned to be "nmax" values long, but which only has data in the first "n" cells.</p>
<h2>Changelog</h2>
<h3>7/17/2008:</h3>
<p>Like "select2" but modified by D. Smith to allow an "nmax" array given, but which only has values in elements 1-n, and to have "arr" be Integer*2 </p>

<p>Definition at line <a class="el" href="select2__dbl_8for_source.html#l00022">22</a> of file <a class="el" href="select2__dbl_8for_source.html">select2_dbl.for</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">c - Like &quot;select&quot; but modified by D. Smith on 7/17/2008</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">c - to allow an &quot;nmax&quot; array given, but which only</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">c - has values in elements 1-n</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;      <span class="keywordtype">INTEGER</span> k,n,nmax</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;      <span class="keywordtype">REAL*8</span> <a class="code" href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a>,arr(nmax)</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="keywordtype">INTEGER</span> i,ir,j,l,mid</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">REAL*8</span> a,temp</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      l=1</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      ir=n</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;1     <span class="keywordflow">if</span>(ir-l.le.1)<span class="keywordflow">then</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordflow">if</span>(ir-l.eq.1)<span class="keywordflow">then</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;          <span class="keywordflow">if</span>(arr(ir).lt.arr(l))<span class="keywordflow">then</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            temp=arr(l)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            arr(l)=arr(ir)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            arr(ir)=temp</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a>=arr(k)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        mid=(l+ir)/2</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        temp=arr(mid)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        arr(mid)=arr(l+1)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        arr(l+1)=temp</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">if</span>(arr(l+1).gt.arr(ir))<span class="keywordflow">then</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          temp=arr(l+1)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;          arr(l+1)=arr(ir)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;          arr(ir)=temp</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span>(arr(l).gt.arr(ir))<span class="keywordflow">then</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          temp=arr(l)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          arr(l)=arr(ir)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          arr(ir)=temp</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span>(arr(l+1).gt.arr(l))<span class="keywordflow">then</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          temp=arr(l+1)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;          arr(l+1)=arr(l)</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;          arr(l)=temp</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        i=l+1</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        j=ir</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        a=arr(l)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;3       <span class="keywordflow">continue</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          i=i+1</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span>(arr(i).lt.a)<span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;4       <span class="keywordflow">continue</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          j=j-1</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span>(arr(j).gt.a)<span class="keywordflow">goto</span> 4</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">if</span>(j.lt.i)<span class="keywordflow">goto</span> 5</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        temp=arr(i)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        arr(i)=arr(j)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        arr(j)=temp</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;5       arr(l)=arr(j)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        arr(j)=a</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">if</span>(j.ge.k)ir=j-1</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span>(j.le.k)l=i</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">goto</span> 1</div><div class="ttc" id="group__core_html_gace8271d29dcfcca5a034f3c4c79fb3f5"><div class="ttname"><a href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a></div><div class="ttdeci">real *8 function select2(k, n, arr, nmax)</div><div class="ttdoc">Function to select an element of a partially filled, but packed multi dimensional array...</div><div class="ttdef"><b>Definition:</b> <a href="select2__dbl_8for_source.html#l00022">select2_dbl.for:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa591df09d79062c6f540cdb5ab808939"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*4 function select2 </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*4, dimension(nmax)&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to select an element of a partially filled, but packed multi dimensional array, single precision. </p>
<p>Finds the "kth" element of an array, "arr", which is dimensioned to be "nmax" values long, but which only has data in the first "n" cells.</p>
<h2>Changelog</h2>
<h3>7/17/2008:</h3>
<p>Like "select2" but modified by D. Smith to allow an "nmax" array given, but which only has values in elements 1-n, and to have "arr" be Integer*2 </p>

<p>Definition at line <a class="el" href="select2__mod_8for_source.html#l00022">22</a> of file <a class="el" href="select2__mod_8for_source.html">select2_mod.for</a>.</p>
<div class="fragment"><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">c - Like &quot;select&quot; but modified by D. Smith on 7/17/2008</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">c - to allow an &quot;nmax&quot; array given, but which only</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">c - has values in elements 1-n.  Maintain the Real*4 nature of arr.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">c - Finds the &quot;kth&quot; element of an array, &quot;arr&quot;, which</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">c - is dimensioned to be &quot;nmax&quot; values long, but which</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">c - only has data in the first &quot;n&quot; cells.</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      <span class="keywordtype">INTEGER</span> k,n,nmax</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <span class="keywordtype">REAL*4</span> <a class="code" href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a>,arr(nmax)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordtype">INTEGER</span> i,ir,j,l,mid</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keywordtype">REAL*4</span> a,temp</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      l=1</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      ir=n</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;1     <span class="keywordflow">if</span>(ir-l.le.1)<span class="keywordflow">then</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">if</span>(ir-l.eq.1)<span class="keywordflow">then</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;          <span class="keywordflow">if</span>(arr(ir).lt.arr(l))<span class="keywordflow">then</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            temp=arr(l)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            arr(l)=arr(ir)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            arr(ir)=temp</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordflow">          endif</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a>=arr(k)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">return</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        mid=(l+ir)/2</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        temp=arr(mid)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        arr(mid)=arr(l+1)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        arr(l+1)=temp</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span>(arr(l+1).gt.arr(ir))<span class="keywordflow">then</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          temp=arr(l+1)</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          arr(l+1)=arr(ir)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          arr(ir)=temp</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">if</span>(arr(l).gt.arr(ir))<span class="keywordflow">then</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;          temp=arr(l)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;          arr(l)=arr(ir)</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;          arr(ir)=temp</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span>(arr(l+1).gt.arr(l))<span class="keywordflow">then</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          temp=arr(l+1)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;          arr(l+1)=arr(l)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;          arr(l)=temp</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordflow">        endif</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        i=l+1</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        j=ir</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        a=arr(l)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;3       <span class="keywordflow">continue</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          i=i+1</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span>(arr(i).lt.a)<span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;4       <span class="keywordflow">continue</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          j=j-1</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">if</span>(arr(j).gt.a)<span class="keywordflow">goto</span> 4</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span>(j.lt.i)<span class="keywordflow">goto</span> 5</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        temp=arr(i)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        arr(i)=arr(j)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        arr(j)=temp</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">goto</span> 3</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;5       arr(l)=arr(j)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        arr(j)=a</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span>(j.ge.k)ir=j-1</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">if</span>(j.le.k)l=i</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordflow">      endif</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">goto</span> 1</div><div class="ttc" id="group__core_html_gace8271d29dcfcca5a034f3c4c79fb3f5"><div class="ttname"><a href="group__core.html#gace8271d29dcfcca5a034f3c4c79fb3f5">select2</a></div><div class="ttdeci">real *8 function select2(k, n, arr, nmax)</div><div class="ttdoc">Function to select an element of a partially filled, but packed multi dimensional array...</div><div class="ttdef"><b>Definition:</b> <a href="select2__dbl_8for_source.html#l00022">select2_dbl.for:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0d5145fe3c5bf851b4a0df2ff7145b48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program subtrc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Subtract one grid from another. </p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infileA</td><td>First Input File Name </td></tr>
    <tr><td class="paramname">infileB</td><td>Second Input File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name of A*B</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin1</code> Input File A</li>
<li><code>lin2</code> Input File B</li>
<li><code>lout</code> Output File to Write A-B </li>
</ul>

<p>Definition at line <a class="el" href="subtrc_8f_source.html#l00025">25</a> of file <a class="el" href="subtrc_8f_source.html">subtrc.f</a>.</p>

</div>
</div>
<a class="anchor" id="ga88bcf2faadec1776f556f062c07ac898"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine vecstats </td>
          <td>(</td>
          <td class="paramtype">character*200&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer*4&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to tell us how many thinned vectors were used to make a grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fname</td><td>vector filename to read </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n</td><td>number of thinned vectors </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="vecstats_8f_source.html#l00012">12</a> of file <a class="el" href="vecstats_8f_source.html">vecstats.f</a>.</p>

<p>Referenced by <a class="el" href="makeplotfiles02_8f_source.html#l00078">makeplotfiles02()</a>.</p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">c - Subroutine to tell us how many thinned vectors were</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">c - used to make a grid</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      <span class="keywordtype">character*200</span> fname</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      <span class="keywordtype">integer*4</span> n</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      <span class="keywordtype">character*80</span> card</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      <span class="keyword">open</span>(90,file=fname,status=<span class="stringliteral">&#39;old&#39;</span>,form=<span class="stringliteral">&#39;formatted&#39;</span>)</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      n = 0</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    1 <span class="keyword">read</span>(90,<span class="stringliteral">&#39;(a)&#39;</span>,end=2)card</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        n = n + 1</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      <span class="keywordflow">goto</span> 1</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    2 <span class="keywordflow">return</span></div></div><!-- fragment -->
<p><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_ga88bcf2faadec1776f556f062c07ac898_icgraph.svg" width="244" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaddd91b04c391f82cba5511c45ae9d691"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program xyz2b </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Part of the NADCON5 <a class="el" href="group__core.html">NADCON5 Core Library</a> , Converts GMT <code>*.grd</code> to a <code>*.b</code> NADCON style grid file. </p>
<p>Turn gmt/netcdf grd dump into my grid file (real number version) assumes grd dump is longitude/latitude/real (binary s.p.)</p>
<h3>Program arguments</h3>
<p>Arguments are newline terminated and read from standard input</p>
<p>When run from the command line, the program prints a prompt for each argument</p>
<p>They are enumerated here </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">infile</td><td>Input File Name </td></tr>
    <tr><td class="paramname">outfile</td><td>Output File Name</td></tr>
  </table>
  </dd>
</dl>
<h3>Program Inputs:</h3>
<ul>
<li><code>lin</code> Input File (<code>*.grd</code>)</li>
</ul>
<h3>Program Outputs:</h3>
<ul>
<li><code>lout</code> Output File (<code>*.b</code>) </li>
</ul>

<p>Definition at line <a class="el" href="xyz2b_8f_source.html#l00029">29</a> of file <a class="el" href="xyz2b_8f_source.html">xyz2b.f</a>.</p>

<p>References <a class="el" href="xyz2b_8f_source.html#l00181">put1()</a>, <a class="el" href="xyz2b_8f_source.html#l00203">put2()</a>, <a class="el" href="xyz2b_8f_source.html#l00224">w1()</a>, and <a class="el" href="xyz2b_8f_source.html#l00236">w2()</a>.</p>

<p><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__core_gaddd91b04c391f82cba5511c45ae9d691_cgraph.svg" width="163" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Dec 1 2017 02:57:19 for NADCON5-ng by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
